{"version":3,"file":"static/js/84789.299252d980.chunk.js","mappings":"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","sources":["webpack://web/../../packages/kit/src/views/DAppConnection/pages/DefaultWalletSettingsModal.tsx"],"sourcesContent":["import _isNil from\"lodash/isNil\";import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{useCallback,useEffect,useMemo,useRef}from'react';import{useIntl}from'react-intl';import{Divider,ESwitchSize,Image,ListView,Page,Skeleton,Stack,Switch,Toast}from'@onekeyhq/components';import{EAppEventBusNames,appEventBus}from'@onekeyhq/shared/src/eventBus/appEventBus';import{ETranslations}from'@onekeyhq/shared/src/locale';import platformEnv from'@onekeyhq/shared/src/platformEnv';import backgroundApiProxy from\"../../../background/instance/backgroundApiProxy\";import{ListItem}from\"../../../components/ListItem\";import{usePromiseResult}from\"../../../hooks/usePromiseResult\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EmptyGuide(){return _jsx(Stack,{w:\"100%\",px:22,py:\"$2.5\",alignItems:\"center\",justifyContent:\"center\",\"data-sentry-element\":\"Stack\",\"data-sentry-component\":\"EmptyGuide\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DefaultWalletSettingsModal.tsx\",children:_jsx(Image,{w:\"$80\",h:341,source:require('@onekeyhq/kit/assets/extension_menu.png'),\"data-sentry-element\":\"Image\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DefaultWalletSettingsModal.tsx\"})});}function DefaultWalletSettingsModal(){var _result$isDefaultWall;var intl=useIntl();var{result,run}=usePromiseResult(_asyncToGenerator(function*(){return backgroundApiProxy.serviceContextMenu.getDefaultWalletSettingsWithIcon();}),[]);var previousResultRef=useRef(null);useEffect(function(){if(result){previousResultRef.current=result;}},[result]);useEffect(function(){appEventBus.addListener(EAppEventBusNames.ExtensionContextMenuUpdate,run);return function(){appEventBus.removeListener(EAppEventBusNames.ExtensionContextMenuUpdate,run);};},[run]);var setIsDefaultWallet=useCallback(function(){var _ref2=_asyncToGenerator(function*(val){yield backgroundApiProxy.serviceContextMenu.setIsDefaultWallet(val);});return function(_x){return _ref2.apply(this,arguments);};}(),[]);var getCurrentOrigin=useCallback(function(){return new Promise(function(resolve,reject){chrome.tabs.query({active:true,currentWindow:true},function(){var _ref3=_asyncToGenerator(function*(tabs){if(tabs[0]){try{var _tabs$0$url;var currentOrigin=new URL((_tabs$0$url=tabs[0]?.url)!=null?_tabs$0$url:'').origin;resolve(currentOrigin);}catch(e){reject(e);}}});return function(_x2){return _ref3.apply(this,arguments);};}());});},[]);var refreshContextMenu=useCallback(function(){var _ref4=_asyncToGenerator(function*(origin){if(!false)return;if(!previousResultRef.current)return;var currentOrigin=yield getCurrentOrigin();if(origin&&origin!==currentOrigin){return;}return backgroundApiProxy.serviceContextMenu.updateAndNotify({origin:currentOrigin,previousResult:previousResultRef.current});});return function(_x3){return _ref4.apply(this,arguments);};}(),[getCurrentOrigin]);var onToggleDefaultWallet=useCallback(_asyncToGenerator(function*(){var isDefaultWallet=!result?.isDefaultWallet;yield setIsDefaultWallet(isDefaultWallet);Toast.success({title:isDefaultWallet?intl.formatMessage({id:ETranslations.explore_default_wallet_set}):intl.formatMessage({id:ETranslations.explore_default_wallet_canceled}),message:isDefaultWallet?intl.formatMessage({id:ETranslations.explore_set_default_wallet_description}):intl.formatMessage({id:ETranslations.explore_default_wallet_canceled_desc})});yield refreshContextMenu();setTimeout(function(){void run();},200);}),[intl,refreshContextMenu,result?.isDefaultWallet,run,setIsDefaultWallet]);var removeExcludedDApp=useCallback(function(){var _ref6=_asyncToGenerator(function*(origin){yield backgroundApiProxy.serviceContextMenu.removeExcludedDApp(origin);if(result?.isDefaultWallet){Toast.success({title:intl.formatMessage({id:ETranslations.explore_default_wallet_set}),message:intl.formatMessage({id:ETranslations.explore_set_default_wallet_description})});}yield refreshContextMenu(origin);void run();});return function(_x4){return _ref6.apply(this,arguments);};}(),[intl,run,result?.isDefaultWallet,refreshContextMenu]);var displayExcludedList=useMemo(function(){if(typeof result?.isDefaultWallet==='boolean'&&!result.isDefaultWallet){return false;}return true;},[result?.isDefaultWallet]);var renderItem=useCallback(function({item}){return _jsx(ListItem,{title:new URL(item.origin).hostname,titleProps:{style:{wordBreak:'break-all'}},avatarProps:{src:item.logo,fallbackProps:{children:_jsx(Skeleton,{w:\"$10\",h:\"$10\"})}},onPress:function(){return removeExcludedDApp(item.origin);},children:_jsx(ListItem.IconButton,{icon:\"DeleteOutline\",iconProps:{color:'$iconSubdued'}})},item.origin);},[removeExcludedDApp]);var renderList=useCallback(function(){if(_isNil(result?.excludedDappListWithLogo)){return null;}if(result.excludedDappListWithLogo.length===0){return _jsx(EmptyGuide,{});}return _jsx(ListView,{keyExtractor:function(item){return item.origin;},data:result.excludedDappListWithLogo,estimatedItemSize:\"$10\",renderItem:renderItem});},[result?.excludedDappListWithLogo,renderItem]);return _jsxs(Page,{\"data-sentry-element\":\"Page\",\"data-sentry-component\":\"DefaultWalletSettingsModal\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DefaultWalletSettingsModal.tsx\",children:[_jsx(Page.Header,{title:intl.formatMessage({id:ETranslations.settings_default_wallet_settings}),\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DefaultWalletSettingsModal.tsx\"}),_jsxs(Page.Body,{\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DefaultWalletSettingsModal.tsx\",children:[_jsx(ListItem,{title:intl.formatMessage({id:ETranslations.explore_set_default}),subtitle:intl.formatMessage({id:ETranslations.explore_set_default_wallet_description}),\"data-sentry-element\":\"ListItem\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DefaultWalletSettingsModal.tsx\",children:_jsx(Switch,{size:ESwitchSize.small,value:(_result$isDefaultWall=result?.isDefaultWallet)!=null?_result$isDefaultWall:true,onChange:onToggleDefaultWallet,\"data-sentry-element\":\"Switch\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DefaultWalletSettingsModal.tsx\"})}),displayExcludedList?_jsxs(_Fragment,{children:[_jsx(Divider,{my:\"$2.5\"}),_jsx(ListItem,{title:intl.formatMessage({id:ETranslations.explore_excluded_dapps}),subtitle:intl.formatMessage({id:ETranslations.explore_excluded_dapps_description})}),renderList()]}):null]})]});}export default DefaultWalletSettingsModal;"],"names":["EmptyGuide","Stack","w","px","py","alignItems","justifyContent","children","Image","h","source","DefaultWalletSettingsModal","_result$isDefaultWall","intl","result","run","serviceContextMenu","getDefaultWalletSettingsWithIcon","previousResultRef","useRef","useEffect","current","addListener","ExtensionContextMenuUpdate","removeListener","_ref2","_ref4","_ref6","setIsDefaultWallet","useCallback","val","_x","apply","this","arguments","getCurrentOrigin","Promise","resolve","reject","_ref3","chrome","tabs","query","active","currentWindow","_tabs$0$url","currentOrigin","URL","url","origin","e","_x2","refreshContextMenu","_x3","onToggleDefaultWallet","isDefaultWallet","Toast","success","title","formatMessage","id","ETranslations","explore_default_wallet_set","explore_default_wallet_canceled","message","explore_set_default_wallet_description","explore_default_wallet_canceled_desc","setTimeout","removeExcludedDApp","_x4","displayExcludedList","useMemo","renderItem","item","hostname","titleProps","style","wordBreak","avatarProps","src","logo","fallbackProps","Skeleton","onPress","IconButton","icon","iconProps","color","renderList","excludedDappListWithLogo","length","ListView","keyExtractor","data","estimatedItemSize","Page","Header","settings_default_wallet_settings","Body","explore_set_default","subtitle","Switch","size","ESwitchSize","small","value","onChange","Divider","my","explore_excluded_dapps","explore_excluded_dapps_description"],"sourceRoot":""}