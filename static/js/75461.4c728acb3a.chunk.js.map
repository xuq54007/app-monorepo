{"version":3,"file":"static/js/75461.4c728acb3a.chunk.js","mappings":"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","sources":["webpack://web/../../packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx","webpack://web/../../packages/kit/src/views/Onboarding/pages/V4Migration/components/V4MigrationLogCopy.tsx","webpack://web/../../packages/kit/src/views/Onboarding/pages/V4Migration/components/V4MigrationModalPage.tsx","webpack://web/../../packages/kit/src/views/Onboarding/pages/V4Migration/hooks/useV4MigrationExitPrevent.tsx","webpack://web/../../node_modules/expo-keep-awake/build/KeepAwake.types.js","webpack://web/../../node_modules/expo-keep-awake/build/ExpoKeepAwake.web.js","webpack://web/../../node_modules/expo-keep-awake/build/index.js"],"sourcesContent":["import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{useCallback,useState}from'react';import{StackActions}from'@react-navigation/native';import{useIntl}from'react-intl';import{Alert,Page,Progress,SizableText,Stack}from'@onekeyhq/components';import backgroundApiProxy from'@onekeyhq/kit/src/background/instance/backgroundApiProxy';import useAppNavigation from'@onekeyhq/kit/src/hooks/useAppNavigation';import{useV4migrationAtom}from'@onekeyhq/kit-bg/src/states/jotai/atoms/v4migration';import{ETranslations}from'@onekeyhq/shared/src/locale';import{EOnboardingPages}from'@onekeyhq/shared/src/routes';import timerUtils from'@onekeyhq/shared/src/utils/timerUtils';import{V4MigrationLogCopy,V4MigrationLogCopyHeaderRight}from\"./components/V4MigrationLogCopy\";import{V4MigrationModalPage}from\"./components/V4MigrationModalPage\";import{EModalExitPreventMode}from\"./hooks/useV4MigrationExitPrevent\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function V4MigrationProgressBar(){var _val$progress;var intl=useIntl();var[val]=useV4migrationAtom();var progress=(_val$progress=val?.progress)!=null?_val$progress:0;return _jsxs(Stack,{flex:1,alignItems:\"center\",justifyContent:\"center\",alignSelf:\"center\",w:\"100%\",maxWidth:\"$80\",\"data-sentry-element\":\"Stack\",\"data-sentry-component\":\"V4MigrationProgressBar\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\",children:[_jsx(Progress,{w:\"100%\",size:\"medium\",value:progress,\"data-sentry-element\":\"Progress\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\"}),_jsx(SizableText,{mt:\"$5\",size:\"$bodyLg\",textAlign:\"center\",\"data-sentry-element\":\"SizableText\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\",children:intl.formatMessage({id:ETranslations.global_pct_complete},{ptc:progress})})]});}export function V4MigrationProcess({route}){var navigation=useAppNavigation();var intl=useIntl();var[migrateLoading,setMigrateLoading]=useState(false);var{serviceV4Migration}=backgroundApiProxy;var[preventClose,setPreventClose]=useState(true);var handleMigrateFromV4=useCallback(_asyncToGenerator(function*(){if(migrateLoading){return;}try{setMigrateLoading(true);var result=yield serviceV4Migration.startV4MigrationFlow();setPreventClose(false);yield timerUtils.wait(300);navigation.dispatch(StackActions.replace(EOnboardingPages.V4MigrationDone,undefined));}finally{setMigrateLoading(false);}}),[migrateLoading,navigation,serviceV4Migration]);return _jsxs(V4MigrationModalPage,{scrollEnabled:false,exitPreventMode:preventClose?EModalExitPreventMode.always:EModalExitPreventMode.disabled,onMounted:handleMigrateFromV4,\"data-sentry-element\":\"V4MigrationModalPage\",\"data-sentry-component\":\"V4MigrationProcess\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\",children:[_jsx(Page.Header,{headerBackTitle:undefined,headerBackVisible:false,headerRight:V4MigrationLogCopyHeaderRight,headerTitle:intl.formatMessage({id:ETranslations.v4_migration_update_in_progress}),disableClose:true,\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\"}),_jsxs(Page.Body,{py:\"$2.5\",px:\"$5\",gap:\"$5\",flex:1,alignItems:\"center\",justifyContent:\"center\",\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\",children:[_jsx(V4MigrationLogCopy,{alignSelf:\"stretch\",\"data-sentry-element\":\"V4MigrationLogCopy\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\",children:_jsx(Alert,{type:\"warning\",title:intl.formatMessage({id:ETranslations.v4_migration_update_in_progress_alert_title}),description:intl.formatMessage({id:ETranslations.v4_migration_update_in_progress_alert_description}),\"data-sentry-element\":\"Alert\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\"})}),_jsx(V4MigrationProgressBar,{\"data-sentry-element\":\"V4MigrationProgressBar\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/V4MigrationProcess.tsx\"})]})]});}export default V4MigrationProcess;","import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"children\"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{Stack}from'@onekeyhq/components';import{MultipleClickStack}from'@onekeyhq/kit/src/components/MultipleClickStack';import platformEnv from'@onekeyhq/shared/src/platformEnv';import{useV4MigrationActions}from\"../hooks/useV4MigrationActions\";import{jsx as _jsx}from\"react/jsx-runtime\";export function V4MigrationLogCopy(_ref){var{children}=_ref,others=_objectWithoutProperties(_ref,_excluded);var actions=useV4MigrationActions();return _jsx(MultipleClickStack,_objectSpread(_objectSpread({},others),{},{onPress:function(){void actions.copyV4MigrationLogs();},\"data-sentry-element\":\"MultipleClickStack\",\"data-sentry-component\":\"V4MigrationLogCopy\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/components/V4MigrationLogCopy.tsx\",children:children}));}export function V4MigrationLogCopyHeaderRight(){return _jsx(V4MigrationLogCopy,{\"data-sentry-element\":\"V4MigrationLogCopy\",\"data-sentry-component\":\"V4MigrationLogCopyHeaderRight\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/components/V4MigrationLogCopy.tsx\",children:_jsx(Stack,{w:\"$8\",h:\"$8\",backgroundColor:false?'$bgCriticalSubdued':undefined,\"data-sentry-element\":\"Stack\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/components/V4MigrationLogCopy.tsx\"})});}","import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"children\",\"onMounted\",\"exitPreventMode\",\"isAutoStartOnMount\"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{useEffect,useRef}from'react';import{Page}from'@onekeyhq/components';import{useRouteIsFocused as useIsFocused}from'@onekeyhq/kit/src/hooks/useRouteIsFocused';import{v4migrationAtom}from'@onekeyhq/kit-bg/src/states/jotai/atoms';import{EModalExitPreventMode,useV4MigrationExitPrevent}from\"../hooks/useV4MigrationExitPrevent\";import{jsx as _jsx}from\"react/jsx-runtime\";export function V4MigrationModalPage(_ref){var{children,onMounted,exitPreventMode=EModalExitPreventMode.confirm,isAutoStartOnMount}=_ref,rest=_objectWithoutProperties(_ref,_excluded);var timer=useRef(null);var isFocused=useIsFocused();useV4MigrationExitPrevent({exitPreventMode,isAutoStartOnMount});useEffect(function(){if(isFocused){clearTimeout(timer.current);}},[isFocused]);return _jsx(Page,_objectSpread(_objectSpread({scrollEnabled:true,onMounted:_asyncToGenerator(function*(){yield v4migrationAtom.set(function(v){return _objectSpread(_objectSpread({},v),{},{isMigrationModalOpen:true});});onMounted?.();}),onUnmounted:function(){},onClose:function(){}},rest),{},{\"data-sentry-element\":\"Page\",\"data-sentry-component\":\"V4MigrationModalPage\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/components/V4MigrationModalPage.tsx\",children:children}));}","import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{useCallback,useEffect,useState}from'react';import{useKeepAwake}from'expo-keep-awake';import{useIntl}from'react-intl';import Alert from\"react-native-web/dist/exports/Alert\";import BackHandler from\"react-native-web/dist/exports/BackHandler\";import{Checkbox,Dialog,SizableText,Stack,usePreventRemove}from'@onekeyhq/components';import useAppNavigation from'@onekeyhq/kit/src/hooks/useAppNavigation';import{useRouteIsFocused as useIsFocused}from'@onekeyhq/kit/src/hooks/useRouteIsFocused';import{useV4migrationPersistAtom}from'@onekeyhq/kit-bg/src/states/jotai/atoms';import{ETranslations}from'@onekeyhq/shared/src/locale';import platformEnv from'@onekeyhq/shared/src/platformEnv';import{useV4MigrationActions}from\"./useV4MigrationActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var isNavExitConfirmShow=false;export var EModalExitPreventMode=function(EModalExitPreventMode){EModalExitPreventMode[\"always\"]=\"always\";EModalExitPreventMode[\"confirm\"]=\"confirm\";EModalExitPreventMode[\"disabled\"]=\"disabled\";return EModalExitPreventMode;}({});function ModalExitPreventDialogContent({message,onCancelText,onConfirmText,preventRemoveData,isAutoStartOnMount}){var intl=useIntl();var navigation=useAppNavigation();var[v4MigrationPersistData,setV4MigrationPersistData]=useV4migrationPersistAtom();var[dontShowAgain,setDontShowAgain]=useState(false);return _jsxs(Stack,{\"data-sentry-element\":\"Stack\",\"data-sentry-component\":\"ModalExitPreventDialogContent\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/hooks/useV4MigrationExitPrevent.tsx\",children:[_jsx(SizableText,{\"data-sentry-element\":\"SizableText\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/hooks/useV4MigrationExitPrevent.tsx\",children:message}),isAutoStartOnMount&&(v4MigrationPersistData?.v4migrationAutoStartCount||0)>=3?_jsx(Stack,{children:_jsx(Checkbox,{value:dontShowAgain,onChange:function(){return setDontShowAgain(!dontShowAgain);},label:intl.formatMessage({id:ETranslations.v4_migration_exit_migration_checkbox_label})})}):null,_jsx(Dialog.Footer,{onConfirmText:onConfirmText,onConfirm:function(){navigation.dispatch(preventRemoveData.action);if(dontShowAgain){setV4MigrationPersistData(function(v){return _objectSpread(_objectSpread({},v),{},{v4migrationAutoStartDisabled:true});});}},onCancelText:onCancelText,\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/V4Migration/hooks/useV4MigrationExitPrevent.tsx\"})]});}export function useModalExitPrevent({exitPreventMode,isAutoStartOnMount,title,message,onConfirmText,onCancelText}){var isFocused=useIsFocused();var navPreventRemoveCallback=useCallback(function({data}){if(isNavExitConfirmShow){return;}isNavExitConfirmShow=true;Dialog.show({title,renderContent:_jsx(ModalExitPreventDialogContent,{onCancelText:onCancelText,onConfirmText:onConfirmText,preventRemoveData:data,message:message,isAutoStartOnMount:isAutoStartOnMount}),onClose:function(){isNavExitConfirmShow=false;}});},[isAutoStartOnMount,message,onCancelText,onConfirmText,title]);var shouldPreventRemove=exitPreventMode!==EModalExitPreventMode.disabled&&isFocused;var preventRemoveCallback=exitPreventMode===EModalExitPreventMode.confirm?navPreventRemoveCallback:function(){return null;};usePreventRemove(shouldPreventRemove,preventRemoveCallback);}export function useAppExitPrevent({message,title}){var intl=useIntl();useEffect(function(){if(platformEnv.isRuntimeBrowser&&!platformEnv.isExtensionUiPopup){var fn=function(event){event.preventDefault();event.returnValue=true;return message;};window.addEventListener('beforeunload',fn);return function(){window.removeEventListener('beforeunload',fn);};}},[message]);useEffect(function(){var onBackPress=function(){Alert.alert(title,message,[{text:intl.formatMessage({id:ETranslations.global_cancel}),onPress:function(){},style:'cancel'},{text:intl.formatMessage({id:ETranslations.global_quit}),onPress:function(){return BackHandler.exitApp();}}],{cancelable:false});return true;};var backHandler=BackHandler.addEventListener('hardwareBackPress',onBackPress);return function(){return backHandler.remove();};},[message,title,intl]);}export function useExtensionV4MigrationFromExpandTab(){var actions=useV4MigrationActions();useEffect(function(){if(platformEnv.isExtensionUiPopup){void actions.openV4MigrationOfExtension();window.close();}},[actions]);}export function useIsV4MigrationAutoStartFirstTime(){var[v4migrationPersistData]=useV4migrationPersistAtom();var isAutoStartInFirstTime=!v4migrationPersistData.v4migrationAutoStartDisabled&&(!v4migrationPersistData?.v4migrationAutoStartCount||v4migrationPersistData?.v4migrationAutoStartCount<=1);return isAutoStartInFirstTime;}export function useV4MigrationExitPrevent({exitPreventMode,isAutoStartOnMount}){var intl=useIntl();var title=intl.formatMessage({id:ETranslations.confirm_exit_dialog_title});var message=intl.formatMessage({id:ETranslations.confirm_exit_dialog_desc});var onConfirmText=intl.formatMessage({id:ETranslations.global_exit});var onCancelText=intl.formatMessage({id:ETranslations.global_cancel});var isAutoStartInFirstTime=useIsV4MigrationAutoStartFirstTime();useKeepAwake();var shouldAlwaysPreventExit=isAutoStartInFirstTime&&exitPreventMode===EModalExitPreventMode.confirm;useModalExitPrevent({exitPreventMode:shouldAlwaysPreventExit?EModalExitPreventMode.always:exitPreventMode,isAutoStartOnMount,title,message,onConfirmText,onCancelText});useAppExitPrevent({title,message});useExtensionV4MigrationFromExpandTab();}","export var KeepAwakeEventState;(function(KeepAwakeEventState){KeepAwakeEventState[\"RELEASE\"]=\"release\";})(KeepAwakeEventState||(KeepAwakeEventState={}));","import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{CodedError,Platform}from'expo-modules-core';import{KeepAwakeEventState}from\"./KeepAwake.types\";var wakeLockMap={};export default{isAvailableAsync(){return _asyncToGenerator(function*(){if(Platform.isDOMAvailable){return'wakeLock'in navigator;}return false;})();},activate(tag){return _asyncToGenerator(function*(){if(!Platform.isDOMAvailable){return;}var wakeLock=yield navigator.wakeLock.request('screen');wakeLockMap[tag]=wakeLock;})();},deactivate(tag){return _asyncToGenerator(function*(){if(!Platform.isDOMAvailable){return;}if(wakeLockMap[tag]){wakeLockMap[tag].release?.();delete wakeLockMap[tag];}else{throw new CodedError('ERR_KEEP_AWAKE_TAG_INVALID',`The wake lock with tag ${tag} has not activated yet`);}})();},addListenerForTag(tag,listener){var eventListener=function(){listener({state:KeepAwakeEventState.RELEASE});};var sentinel=wakeLockMap[tag];if(sentinel){if('addEventListener'in sentinel){sentinel.addEventListener?.('release',eventListener);}else{sentinel.onrelease=eventListener;}}return{remove:function(){var sentinel=wakeLockMap[tag];if(sentinel){if(sentinel.removeEventListener){sentinel.removeEventListener('release',eventListener);}else{sentinel.onrelease=null;}}}};}};","import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{UnavailabilityError}from'expo-modules-core';import{useEffect}from'react';import ExpoKeepAwake from\"./ExpoKeepAwake\";export var ExpoKeepAwakeTag='ExpoKeepAwakeDefaultTag';export function isAvailableAsync(){return _isAvailableAsync.apply(this,arguments);}function _isAvailableAsync(){_isAvailableAsync=_asyncToGenerator(function*(){if(ExpoKeepAwake.isAvailableAsync){return yield ExpoKeepAwake.isAvailableAsync();}return true;});return _isAvailableAsync.apply(this,arguments);}export function useKeepAwake(tag=ExpoKeepAwakeTag,options){useEffect(function(){var isMounted=true;activateKeepAwakeAsync(tag).then(function(){if(isMounted&&ExpoKeepAwake.addListenerForTag&&options?.listener){addListener(tag,options.listener);}});return function(){isMounted=false;if(options?.suppressDeactivateWarnings){deactivateKeepAwake(tag).catch(function(){});}else{deactivateKeepAwake(tag);}};},[tag]);}export function activateKeepAwake(tag=ExpoKeepAwakeTag){return activateKeepAwakeAsync(tag);}export function activateKeepAwakeAsync(){return _activateKeepAwakeAsync.apply(this,arguments);}function _activateKeepAwakeAsync(){_activateKeepAwakeAsync=_asyncToGenerator(function*(tag=ExpoKeepAwakeTag){yield ExpoKeepAwake.activate?.(tag);});return _activateKeepAwakeAsync.apply(this,arguments);}export function deactivateKeepAwake(){return _deactivateKeepAwake.apply(this,arguments);}function _deactivateKeepAwake(){_deactivateKeepAwake=_asyncToGenerator(function*(tag=ExpoKeepAwakeTag){yield ExpoKeepAwake.deactivate?.(tag);});return _deactivateKeepAwake.apply(this,arguments);}export function addListener(tagOrListener,listener){if(!ExpoKeepAwake.addListenerForTag){throw new UnavailabilityError('ExpoKeepAwake','addListenerForTag');}var tag=typeof tagOrListener==='string'?tagOrListener:ExpoKeepAwakeTag;var _listener=typeof tagOrListener==='function'?tagOrListener:listener;return ExpoKeepAwake.addListenerForTag(tag,_listener);}export*from\"./KeepAwake.types\";"],"names":["V4MigrationProgressBar","_val$progress","intl","val","progress","Stack","flex","alignItems","justifyContent","alignSelf","w","maxWidth","children","Progress","size","value","SizableText","mt","textAlign","formatMessage","id","ETranslations","global_pct_complete","ptc","V4MigrationProcess","route","navigation","migrateLoading","setMigrateLoading","useState","serviceV4Migration","preventClose","setPreventClose","handleMigrateFromV4","useCallback","startV4MigrationFlow","wait","dispatch","replace","V4MigrationDone","undefined","scrollEnabled","exitPreventMode","always","disabled","onMounted","Page","Header","headerBackTitle","headerBackVisible","headerRight","headerTitle","v4_migration_update_in_progress","disableClose","Body","py","px","gap","Alert","type","title","v4_migration_update_in_progress_alert_title","description","v4_migration_update_in_progress_alert_description","_excluded","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","V4MigrationLogCopy","_ref","others","actions","onPress","copyV4MigrationLogs","V4MigrationLogCopyHeaderRight","h","backgroundColor","V4MigrationModalPage","confirm","isAutoStartOnMount","rest","timer","useRef","isFocused","useEffect","clearTimeout","current","v4migrationAtom","set","v","isMigrationModalOpen","onUnmounted","onClose","isNavExitConfirmShow","EModalExitPreventMode","ModalExitPreventDialogContent","message","onCancelText","onConfirmText","preventRemoveData","v4MigrationPersistData","setV4MigrationPersistData","useV4migrationPersistAtom","dontShowAgain","setDontShowAgain","v4migrationAutoStartCount","Checkbox","onChange","label","v4_migration_exit_migration_checkbox_label","Dialog","Footer","onConfirm","action","v4migrationAutoStartDisabled","useIsV4MigrationAutoStartFirstTime","v4migrationPersistData","useV4MigrationExitPrevent","confirm_exit_dialog_title","confirm_exit_dialog_desc","global_exit","global_cancel","isAutoStartInFirstTime","useModalExitPrevent","navPreventRemoveCallback","data","show","renderContent","shouldPreventRemove","preventRemoveCallback","usePreventRemove","useAppExitPrevent","isRuntimeBrowser","fn","event","preventDefault","returnValue","window","addEventListener","removeEventListener","backHandler","A","alert","text","style","global_quit","exitApp","cancelable","remove","useExtensionV4MigrationFromExpandTab","openV4MigrationOfExtension","close","KeepAwakeEventState","wakeLockMap","isAvailableAsync","Platform","isDOMAvailable","navigator","activate","tag","wakeLock","request","deactivate","CodedError","release","addListenerForTag","listener","eventListener","state","RELEASE","sentinel","onrelease","ExpoKeepAwakeTag","useKeepAwake","options","isMounted","activateKeepAwakeAsync","then","addListener","tagOrListener","UnavailabilityError","_listener","suppressDeactivateWarnings","deactivateKeepAwake","catch","_activateKeepAwakeAsync","this","_deactivateKeepAwake"],"sourceRoot":""}