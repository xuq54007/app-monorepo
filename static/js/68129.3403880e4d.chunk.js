!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="c509cb05-2363-49a1-9b5e-3751d4e3a933",e._sentryDebugIdIdentifier="sentry-dbid-c509cb05-2363-49a1-9b5e-3751d4e3a933")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.5.0 (2024121652)"},(self.webpackChunkweb=self.webpackChunkweb||[]).push([[68129],{389587:(e,r,t)=>{t.d(r,{K:()=>n});var n=80},82506:(e,r,t)=>{t.d(r,{d:()=>useDebounce});var n=t(578104);function useDebounce(e,r,t){var[o]=(0,n.d7)(e,r,t);return o}},471230:(e,r,t)=>{t.d(r,{YG:()=>w,U9:()=>o.U});t(490343),t(791088),t(193068);var n=t(498356);t(831085);var o=t(952954),a=t(324586),s=t(586330),i=t(514041),l=t(471169),d=t(318822),c=(t(334439),t(663522)),u=t(584186),p=t(643087),m=t(131397),f=t(621591);function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,a.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var g=0,b=!1,y=!1;var w=(0,i.memo)((function OnboardingOnMountCmp(){var e=(0,m.t1)(),r=(0,n.A)(),t=(0,f.D)(),[o,a]=(0,l.useV4migrationPersistAtom)(),w=o?.downgradeWarningConfirmed;(0,i.useRef)(w).current=w;var k=(0,i.useCallback)((0,s.A)((function*(){(yield p.A.serviceV4Migration.checkShouldMigrateV4OnMount())&&(b||(b=!0,yield p.A.serviceV4Migration.migrateBaseSettings()))})),[]),v=(0,i.useCallback)((0,s.A)((function*({checkingV4Migration:r}={}){try{if(r)if(yield p.A.serviceV4Migration.checkShouldMigrateV4OnMount()){if(yield k(),yield u.A.wait(600),!y){y=!0,yield t.navigateToV4MigrationPage({isAutoStartOnMount:!0});var n=Date.now();n-g>3e3&&(g=n,a((function(e){return _objectSpread(_objectSpread({},e),{},{v4migrationAutoStartCount:(e.v4migrationAutoStartCount||0)+1})})))}return}}catch(e){}if(!(0,m.p1)()){var{isOnboardingDone:o}=yield p.A.serviceOnboarding.isOnboardingDone();o||c.Ay.isWebDappMode||e({isFullModal:!0})}})),[k,a,e,t]),h=(0,i.useCallback)((0,s.A)((function*(){yield v({checkingV4Migration:!0})})),[v,k,a]);return(0,i.useEffect)((function(){}),[]),(0,i.useEffect)((function(){}),[a]),(0,i.useEffect)((function(){}),[r]),(0,i.useEffect)((function(){}),[t]),(0,i.useEffect)((function(){h()}),[h]),(0,i.useEffect)((function(){var fn=function(){v({checkingV4Migration:!1})};return d.iL.on(d.Tu.WalletClear,fn),function(){d.iL.off(d.Tu.WalletClear,fn)}}),[v]),null}))},68129:(e,r,t)=>{t.r(r),t.d(r,{default:()=>O});var n=t(586330),o=t(514041),a=t(908867),s=t(490343),i=t(643087),l=t(325809),d=t(575995),c=t(660395),u=t(370968),p=t(389587),m=t(498356),f=t(82506),g=t(911998),b=t(162616),y=t(834015),w=t(625931),k=t(181447),v=t(334439),h=t(296827),I=t(714191),A=t(471230),x=t(831085),E=function(e){return e.Address="Address",e.PublicKey="PublicKey",e}(E||{}),FormDeriveTypeInput=function({networkId:e,deriveInfoItems:r,fieldName:t}){var n=(0,a.A)();return(0,x.jsx)(s.Stack,{mt:"$2","data-sentry-element":"Stack","data-sentry-component":"FormDeriveTypeInput","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx",children:(0,x.jsx)(s.Form.Field,{label:n.formatMessage({id:v.ETranslations.derivation_path}),name:t,"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx",children:(0,x.jsx)(d.l$,{networkId:e,enabledItems:r,renderTrigger:function({label:e,onPress:r}){return(0,x.jsxs)(s.Stack,{testID:"derive-type-input",userSelect:"none",flexDirection:"row",px:"$3.5",py:"$2.5",borderWidth:1,borderColor:"$borderStrong",borderRadius:"$3",$gtMd:{px:"$3",py:"$1.5",borderRadius:"$2"},borderCurve:"continuous",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},onPress:r,children:[(0,x.jsx)(s.SizableText,{flex:1,children:e}),(0,x.jsx)(s.Icon,{name:"ChevronDownSmallOutline",color:"$iconSubdued",mr:"$-0.5"})]})},"data-sentry-element":"DeriveTypeSelectorFormInput","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx"})})})};function ImportAddress(){var e=(0,a.A)(),r=(0,s.useMedia)(),t=(0,m.A)(),{result:d}=(0,g.yk)((0,n.A)((function*(){var e=yield i.A.serviceNetwork.getPublicKeyExportOrWatchingAccountEnabledNetworks(),r=e.map((function(e){return e.network.id})),t=e.filter((function(e){return e.publicKeyExportEnabled})).map((function(e){return e.network.id})),n=e.filter((function(e){return e.watchingAccountEnabled})).map((function(e){return e.network.id}));return{networkIds:r,publicKeyExportEnabled:new Set(t),watchingAccountEnabled:new Set(n)}})),[],{initResult:{networkIds:[],publicKeyExportEnabled:new Set([]),watchingAccountEnabled:new Set([])}}),I=(0,b.z$)(),[O,_]=(0,o.useState)(E.Address),{activeAccount:{network:j}}=(0,c.w)({num:0}),{onPasteClearText:S}=(0,s.useClipboard)(),M=(0,s.useForm)({values:{networkId:j?.id&&j.id!==(0,w.V)().onekeyall?j?.id:(0,w.V)().btc,deriveType:void 0,publicKeyValue:"",addressValue:{raw:"",resolved:void 0},accountName:""},mode:"onChange",reValidateMode:"onBlur"}),{setValue:T,control:P}=M,[V,W]=(0,o.useState)(),D=(0,o.useRef)(!1),C=(0,s.useFormWatch)({control:P,name:"networkId"}),F=(0,s.useFormWatch)({control:P,name:"publicKeyValue"}),K=(0,s.useFormWatch)({control:P,name:"addressValue"}),N=(0,s.useFormWatch)({control:P,name:"accountName"}),$=(0,f.d)(F.trim(),600),R=(0,f.d)(N?.trim()||"",600),z=(0,o.useCallback)((0,n.A)((function*(){if(R)try{yield i.A.serviceAccount.ensureAccountNameNotDuplicate({name:R,walletId:k.Hk}),M.clearErrors("accountName")}catch(e){M.setError("accountName",{message:e?.message})}else M.clearErrors("accountName");if(T("deriveType",void 0),$&&C){var e=yield i.A.servicePassword.encodeSensitiveText({text:$});try{if(!d.publicKeyExportEnabled.has(C))throw new Error(`Network not supported: ${C}`);var r=yield i.A.serviceAccount.validateGeneralInputOfImporting({input:e,networkId:C,validateXpub:!0});W(r)}catch(e){W({isValid:!1})}}else W(void 0)})),[R,T,$,C,M,d.publicKeyExportEnabled]);(0,o.useEffect)((function(){(0,n.A)((function*(){try{D.current=!0,yield z()}finally{D.current=!1}}))()}),[z]);var H,{start:B}=(0,y.A)(),L=(M.watch("deriveType"),(0,o.useMemo)((function(){return!Object.values(M.formState.errors).filter((function(e){return O===E.PublicKey&&"addressValue"!==e?.ref?.name})).length&&(O===E.Address?!K.pending&&M.formState.isValid:V?.isValid)}),[O,K.pending,V,M.formState])),U=(0,o.useMemo)((function(){return C&&d.publicKeyExportEnabled.has(C)}),[C,d.publicKeyExportEnabled]),Y=(0,o.useMemo)((function(){return O===E.PublicKey&&U}),[O,U]);return(0,x.jsxs)(s.Page,{scrollEnabled:!0,"data-sentry-element":"Page","data-sentry-component":"ImportAddress","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx",children:[(0,x.jsx)(s.Page.Header,{title:e.formatMessage({id:v.ETranslations.global_import_address}),"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx"}),(0,x.jsxs)(s.Page.Body,{px:"$5","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx",children:[(0,x.jsxs)(s.Form,{form:M,"data-sentry-element":"Form","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx",children:[(0,x.jsx)(s.Form.Field,{label:e.formatMessage({id:v.ETranslations.global_network}),name:"networkId","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx",children:(0,x.jsx)(l.YS,{networkIds:d.networkIds,"data-sentry-element":"ControlledNetworkSelectorTrigger","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx"})}),U?(0,x.jsx)(s.SegmentControl,{fullWidth:!0,value:O,onChange:function(e){_(e)},options:[{label:e.formatMessage({id:v.ETranslations.global_address}),value:E.Address,testID:"import-address-address"},{label:e.formatMessage({id:v.ETranslations.global_public_key}),value:E.PublicKey,testID:"import-address-publicKey"}]}):null,Y?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(s.Form.Field,{label:e.formatMessage({id:v.ETranslations.global_public_key}),name:"publicKeyValue",children:(0,x.jsx)(s.Input,{secureTextEntry:!1,placeholder:e.formatMessage({id:v.ETranslations.form_public_key_placeholder}),testID:"import-address-input",size:r.gtMd?"medium":"large",onPaste:S,addOns:[{iconName:"ScanOutline",onPress:(H=(0,n.A)((function*(){var e=yield B({handlers:[],autoHandleResult:!1});M.setValue("publicKeyValue",e.raw)})),function onPress(){return H.apply(this,arguments)})}]})}),V?.deriveInfoItems?(0,x.jsx)(FormDeriveTypeInput,{fieldName:"deriveType",networkId:M.getValues().networkId||"",deriveInfoItems:V?.deriveInfoItems||[]}):null,(0,x.jsx)(x.Fragment,{children:V&&!V?.isValid&&$?(0,x.jsx)(s.SizableText,{size:"$bodyMd",color:"$textCritical",children:e.formatMessage({id:v.ETranslations.form_public_key_error_invalid})}):null})]}):null,Y?null:(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(s.Form.Field,{label:e.formatMessage({id:v.ETranslations.global_address}),name:"addressValue",rules:{validate:(0,u.j)({defaultErrorMessage:e.formatMessage({id:v.ETranslations.form_address_error_invalid})})},children:(0,x.jsx)(u.N,{placeholder:e.formatMessage({id:v.ETranslations.form_address_placeholder}),networkId:null!=C?C:"",testID:"import-address-input"})})}),(0,x.jsx)(s.Form.Field,{label:e.formatMessage({id:v.ETranslations.form_enter_account_name}),name:"accountName","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx",children:(0,x.jsx)(s.Input,{maxLength:p.K,placeholder:e.formatMessage({id:v.ETranslations.form_enter_account_name_placeholder}),"data-sentry-element":"Input","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx"})})]}),(0,x.jsx)(A.U9,{list:[{title:e.formatMessage({id:v.ETranslations.faq_watched_account}),description:e.formatMessage({id:v.ETranslations.faq_watched_account_desc})}],"data-sentry-element":"Tutorials","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx"}),null]}),(0,x.jsx)(s.Page.Footer,{confirmButtonProps:{disabled:!L},onConfirm:(0,n.A)((function*(){var r;yield M.handleSubmit((r=(0,n.A)((function*(r){var n,o,a,l,d=Y?{name:r.accountName,input:null!=(n=r.publicKeyValue)?n:"",networkId:null!=(o=r.networkId)?o:"",deriveType:r.deriveType,shouldCheckDuplicateName:!0}:{name:r.accountName,input:null!=(a=r.addressValue.resolved)?a:"",networkId:null!=(l=r.networkId)?l:"",shouldCheckDuplicateName:!0},c=yield i.A.serviceAccount.addWatchingAccount(d),u=c?.accounts?.[0]?.id;u&&s.Toast.success({title:e.formatMessage({id:v.ETranslations.global_success})}),I.current.updateSelectedAccountForSingletonAccount({num:0,networkId:r.networkId,walletId:k.Hk,othersWalletAccountId:u}),t.popStack(),h.U.account.wallet.importWallet({importMethod:"address"})})),function(e){return r.apply(this,arguments)}))()})),"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx"})]})}const O=function ImportAddressPage(){return(0,x.jsx)(l.b8,{config:{sceneName:I.Zs.home},enabledNum:[0],"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"ImportAddressPage","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx",children:(0,x.jsx)(ImportAddress,{"data-sentry-element":"ImportAddress","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/pages/ImportWallet/ImportAddress.tsx"})})}}}]);
//# sourceMappingURL=68129.3403880e4d.chunk.js.map