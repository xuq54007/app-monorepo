{"version":3,"file":"static/js/81182.e59f64a6fd.chunk.js","mappings":"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","sources":["webpack://web/../../packages/kit/src/views/AssetList/hooks/useAddToken.ts","webpack://web/../../packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx","webpack://web/../../packages/kit/src/views/DAppConnection/pages/DappOpenModalPage.tsx"],"sourcesContent":["import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{useCallback,useEffect,useRef,useState}from'react';import BigNumber from'bignumber.js';import{useDebouncedCallback}from'use-debounce';import{useForm}from'@onekeyhq/components';import{getNetworkIdsMap}from'@onekeyhq/shared/src/config/networkIds';import networkUtils from'@onekeyhq/shared/src/utils/networkUtils';import backgroundApiProxy from\"../../../background/instance/backgroundApiProxy\";import{usePromiseResult}from\"../../../hooks/usePromiseResult\";export function useAddTokenForm({token,networkId}){var isAllNetwork=networkUtils.isAllNetwork({networkId});var getDefaultNetwork=useCallback(function(){if(token&&token.networkId){return token.networkId;}if(isAllNetwork){return getNetworkIdsMap().eth;}return networkId;},[isAllNetwork,networkId,token]);var form=useForm({values:{networkId:getDefaultNetwork(),contractAddress:token?.address||'',symbol:token?.symbol||'',decimals:token?.decimals?new BigNumber(token.decimals).toString():''},mode:'onChange',reValidateMode:'onBlur'});var selectedNetworkIdValue=form.watch('networkId');var contractAddressValue=form.watch('contractAddress');var symbolValue=form.watch('symbol');var decimalsValue=form.watch('decimals');var[isEmptyContract,setIsEmptyContract]=useState(false);var firstRenderRef=useRef(true);var setIsEmptyContractState=useCallback(function(value){if(firstRenderRef.current){return;}if(!token?.address&&!contractAddressValue){return;}setIsEmptyContract(value);},[contractAddressValue,token?.address]);useEffect(function(){if(firstRenderRef.current){firstRenderRef.current=false;return;}void form.trigger('contractAddress');},[isEmptyContract,form]);return{form,isEmptyContract,setIsEmptyContractState,selectedNetworkIdValue,contractAddressValue,symbolValue,decimalsValue};}export function useAddToken({token,walletId,networkId,form,selectedNetworkIdValue,contractAddressValue,setIsEmptyContractState}){var{result:availableNetworks}=usePromiseResult(_asyncToGenerator(function*(){var resp=yield backgroundApiProxy.serviceNetwork.getCustomTokenEnabledNetworks({currentNetworkId:networkId});var networkIds=resp.map(function(o){return o.id;});var network=yield backgroundApiProxy.serviceNetwork.getNetwork({networkId});if(token?.networkId&&!networkIds.includes(token.networkId)){networkIds.push(token.networkId);}return{networkIds,network};}),[networkId,token?.networkId]);var searchedTokenRef=useRef();var fetchContractList=useDebouncedCallback(function(){var _ref2=_asyncToGenerator(function*(params){var _token$isNative;if(!token&&!params.value.trim()){form.setValue('symbol','');form.setValue('decimals','');setIsEmptyContractState(true);return;}var searchResult=yield backgroundApiProxy.serviceCustomToken.searchTokenByContractAddress({walletId,networkId:params.networkId,contractAddress:params.value.trim(),isNative:(_token$isNative=token?.isNative)!=null?_token$isNative:false});if(Array.isArray(searchResult)&&searchResult.length>0&&searchResult[0]?.info){var[firstToken]=searchResult;form.setValue('symbol',firstToken.info.symbol);form.setValue('decimals',new BigNumber(firstToken.info.decimals).toString());searchedTokenRef.current=firstToken.info;setIsEmptyContractState(false);}else{form.setValue('symbol','');form.setValue('decimals','');setIsEmptyContractState(true);}});return function(_x){return _ref2.apply(this,arguments);};}(),300);useEffect(function(){void fetchContractList({value:contractAddressValue,networkId:selectedNetworkIdValue});},[contractAddressValue,selectedNetworkIdValue,fetchContractList]);return{availableNetworks,searchedTokenRef};}export function useAccountInfoForManageToken(){var findAccountInfoForNetwork=useCallback(function(){var _ref3=_asyncToGenerator(function*({accountId,networkId,isOthersWallet,indexedAccountId,deriveType,selectedNetworkId}){var{serviceAccount}=backgroundApiProxy;var hasExistAccountFlag=false;var accountIdForNetwork='';try{if(isOthersWallet){var r=yield serviceAccount.getAccount({accountId,networkId});accountIdForNetwork=r.id;}else{var networkAccount=yield serviceAccount.getNetworkAccount({accountId:undefined,indexedAccountId,networkId:selectedNetworkId,deriveType});accountIdForNetwork=networkAccount.id;}hasExistAccountFlag=true;}catch(e){hasExistAccountFlag=false;}return{hasExistAccountFlag,accountIdForNetwork};});return function(_x2){return _ref3.apply(this,arguments);};}(),[]);return{findAccountInfoForNetwork};}export function useCheckAccountExist({accountId,networkId,isOthersWallet,indexedAccountId,deriveType,selectedNetworkIdValue}){var{findAccountInfoForNetwork}=useAccountInfoForManageToken();var checkAccountIsExist=useCallback(_asyncToGenerator(function*(){return findAccountInfoForNetwork({accountId,networkId,isOthersWallet,indexedAccountId,deriveType,selectedNetworkId:selectedNetworkIdValue});}),[accountId,indexedAccountId,networkId,isOthersWallet,deriveType,selectedNetworkIdValue,findAccountInfoForNetwork]);var{result:hasExistAccount,run:runCheckAccountExist}=usePromiseResult(_asyncToGenerator(function*(){var{hasExistAccountFlag}=yield checkAccountIsExist();return hasExistAccountFlag;}),[checkAccountIsExist]);return{hasExistAccount,runCheckAccountExist,checkAccountIsExist};}","import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{useCallback,useMemo,useState}from'react';import{useRoute}from'@react-navigation/core';import BigNumber from'bignumber.js';import{useIntl}from'react-intl';import{Button,Form,Icon,Input,Page,SizableText,Stack,Toast,XStack}from'@onekeyhq/components';import{AccountSelectorProviderMirror,ControlledNetworkSelectorTrigger}from'@onekeyhq/kit/src/components/AccountSelector';import{AccountSelectorCreateAddressButton}from'@onekeyhq/kit/src/components/AccountSelector/AccountSelectorCreateAddressButton';import useDappApproveAction from'@onekeyhq/kit/src/hooks/useDappApproveAction';import useDappQuery from'@onekeyhq/kit/src/hooks/useDappQuery';import{OneKeyError}from'@onekeyhq/shared/src/errors';import{ETranslations}from'@onekeyhq/shared/src/locale';import networkUtils from'@onekeyhq/shared/src/utils/networkUtils';import{EAccountSelectorSceneName}from'@onekeyhq/shared/types';import backgroundApiProxy from\"../../../background/instance/backgroundApiProxy\";import{NetworkAvatar}from\"../../../components/NetworkAvatar/NetworkAvatar\";import{usePromiseResult}from\"../../../hooks/usePromiseResult\";import{useDappCloseHandler}from\"../../DAppConnection/pages/DappOpenModalPage\";import{useAddToken,useAddTokenForm,useCheckAccountExist}from\"../hooks/useAddToken\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CreateAddressButton(props){var intl=useIntl();return _jsx(Button,_objectSpread(_objectSpread({$md:{flexGrow:1,flexBasis:0,size:'large'},variant:\"primary\"},props),{},{\"data-sentry-element\":\"Button\",\"data-sentry-component\":\"CreateAddressButton\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\",children:intl.formatMessage({id:ETranslations.global_create_address})}));}function AddCustomTokenModal(){var _$sourceInfo$id;var intl=useIntl();var route=useRoute();var{walletId:routeWalletId,networkId:routeNetworkId,indexedAccountId:routeIndexedAccountId,accountId:routeAccountId,isOthersWallet:routeIsOthersWallet,deriveType:routeDeriveType,token:routeToken,onSuccess:routeOnSuccess}=route.params;var{$sourceInfo,walletId:dappWalletId,networkId:dappNetworkId,indexedAccountId:dappIndexedAccountId,accountId:dappAccountId,isOthersWallet:dappIsOthersWallet,deriveType:dappDeriveType,token:dappToken,onSuccess:dappOnSuccess}=useDappQuery();var dappApprove=useDappApproveAction({id:(_$sourceInfo$id=$sourceInfo?.id)!=null?_$sourceInfo$id:'',closeWindowAfterResolved:true});var walletId=dappWalletId!=null?dappWalletId:routeWalletId;var networkId=dappNetworkId!=null?dappNetworkId:routeNetworkId;var indexedAccountId=dappIndexedAccountId!=null?dappIndexedAccountId:routeIndexedAccountId;var accountId=dappAccountId!=null?dappAccountId:routeAccountId;var isOthersWallet=dappIsOthersWallet!=null?dappIsOthersWallet:routeIsOthersWallet;var deriveType=dappDeriveType!=null?dappDeriveType:routeDeriveType;var token=dappToken!=null?dappToken:routeToken;var onSuccess=dappOnSuccess!=null?dappOnSuccess:routeOnSuccess;var isAllNetwork=networkUtils.isAllNetwork({networkId});var{form,isEmptyContract,setIsEmptyContractState,selectedNetworkIdValue,contractAddressValue,symbolValue,decimalsValue}=useAddTokenForm({token,networkId});var{hasExistAccount,runCheckAccountExist,checkAccountIsExist}=useCheckAccountExist({accountId,networkId,isOthersWallet,indexedAccountId,deriveType,selectedNetworkIdValue});var{availableNetworks,searchedTokenRef}=useAddToken({token,walletId,networkId,form,selectedNetworkIdValue,contractAddressValue,setIsEmptyContractState,checkAccountIsExist});var{result:vaultSettings}=usePromiseResult(function(){return backgroundApiProxy.serviceNetwork.getVaultSettings({networkId:selectedNetworkIdValue});},[selectedNetworkIdValue]);var[isLoading,setIsLoading]=useState(false);var disabled=useMemo(function(){if(!hasExistAccount){return true;}if(isEmptyContract){return true;}if(!symbolValue||!new BigNumber(decimalsValue).isInteger()){return true;}if(isLoading){return true;}return false;},[symbolValue,decimalsValue,isEmptyContract,isLoading,hasExistAccount]);var onConfirm=useCallback(function(){var _ref=_asyncToGenerator(function*(close){setIsLoading(true);var{hasExistAccountFlag,accountIdForNetwork}=yield checkAccountIsExist();if(!hasExistAccountFlag){Toast.error({title:'Account not exist'});dappApprove.reject();return;}var values=form.getValues();var{contractAddress,symbol,decimals}=values;if(!contractAddress&&!token?.isNative){setIsLoading(false);Toast.error({title:intl.formatMessage({id:ETranslations.manger_token_custom_token_address_required})});dappApprove.reject({error:new OneKeyError({key:ETranslations.manger_token_custom_token_address_required})});return;}if(!symbol||!new BigNumber(decimals).isInteger()){setIsLoading(false);Toast.error({title:intl.formatMessage({id:ETranslations.send_engine_incorrect_address})});dappApprove.reject({error:new OneKeyError({key:ETranslations.send_engine_incorrect_address})});return;}try{var _searchedTokenRef$cur,_searchedTokenRef$cur2;var tokenInfo=_objectSpread(_objectSpread({address:contractAddress,symbol,decimals:new BigNumber(decimals).toNumber()},searchedTokenRef.current),{},{accountId:accountIdForNetwork,networkId:selectedNetworkIdValue,allNetworkAccountId:isAllNetwork?accountId:undefined,name:(_searchedTokenRef$cur=searchedTokenRef.current?.name)!=null?_searchedTokenRef$cur:'',isNative:(_searchedTokenRef$cur2=searchedTokenRef.current?.isNative)!=null?_searchedTokenRef$cur2:false,$key:`${selectedNetworkIdValue}_${contractAddress}`});yield backgroundApiProxy.serviceCustomToken.activateToken({accountId:accountIdForNetwork,networkId:selectedNetworkIdValue,token:tokenInfo});yield backgroundApiProxy.serviceCustomToken.addCustomToken({token:tokenInfo});}finally{setIsLoading(false);}Toast.success({title:intl.formatMessage({id:ETranslations.address_book_add_address_toast_add_success})});setTimeout(function(){void dappApprove.resolve();onSuccess?.();close?.();},300);});return function(_x){return _ref.apply(this,arguments);};}(),[form,checkAccountIsExist,selectedNetworkIdValue,token?.isNative,intl,onSuccess,isAllNetwork,accountId,searchedTokenRef,dappApprove]);var renderNetworkSelectorFormItem=useCallback(function(){var _availableNetworks$ne;if(isAllNetwork){return _jsx(Form.Field,{label:intl.formatMessage({id:ETranslations.global_chain}),name:\"networkId\",children:_jsx(ControlledNetworkSelectorTrigger,{networkIds:availableNetworks?.networkIds})});}return _jsx(Form.Field,{label:intl.formatMessage({id:ETranslations.global_network}),name:\"networkId\",children:_jsxs(Stack,{userSelect:\"none\",flexDirection:\"row\",alignItems:\"center\",borderRadius:\"$3\",borderWidth:1,borderCurve:\"continuous\",borderColor:\"$borderStrong\",px:\"$3\",py:\"$2.5\",$gtMd:{borderRadius:'$2',py:'$2'},testID:\"network-selector-input\",children:[_jsx(NetworkAvatar,{networkId:networkId,size:\"$6\"}),_jsx(SizableText,{testID:\"network-selector-input-text\",px:14,flex:1,size:\"$bodyLg\",children:(_availableNetworks$ne=availableNetworks?.network.name)!=null?_availableNetworks$ne:''})]})});},[availableNetworks,intl,isAllNetwork,networkId]);var handleOnClose=useDappCloseHandler(dappApprove);return _jsxs(Page,{onClose:handleOnClose,\"data-sentry-element\":\"Page\",\"data-sentry-component\":\"AddCustomTokenModal\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\",children:[_jsx(Page.Header,{title:intl.formatMessage({id:ETranslations.manage_token_custom_token_title}),\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\"}),_jsx(Page.Body,{px:\"$5\",\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\",children:_jsxs(Form,{form:form,\"data-sentry-element\":\"Form\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\",children:[renderNetworkSelectorFormItem(),vaultSettings?.isNativeTokenContractAddressEmpty?null:_jsx(Form.Field,{label:intl.formatMessage({id:ETranslations.manage_token_custom_token_contract_address}),rules:{validate:function(){if(isEmptyContract){return intl.formatMessage({id:ETranslations.Token_manage_custom_token_address_faild});}}},name:\"contractAddress\",children:_jsx(Input,{size:\"large\",$gtMd:{size:'medium'},editable:!token?.isNative})}),_jsx(Form.Field,{label:intl.formatMessage({id:ETranslations.manage_token_custom_token_symbol}),name:\"symbol\",\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\",children:_jsx(Input,{size:\"large\",$gtMd:{size:'medium'},editable:false,\"data-sentry-element\":\"Input\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\"})}),_jsx(Form.Field,{label:intl.formatMessage({id:ETranslations.manage_token_custom_token_decimal}),name:\"decimals\",\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\",children:_jsx(Input,{size:\"large\",$gtMd:{size:'medium'},editable:false,\"data-sentry-element\":\"Input\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\"})})]})}),_jsx(Page.Footer,{onConfirmText:intl.formatMessage({id:ETranslations.manage_token_custom_token_add_btn}),onConfirm:onConfirm,confirmButtonProps:{loading:isLoading,disabled},\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\",children:hasExistAccount?undefined:_jsx(Stack,{testID:\"add-custom-token-modal-footer\",p:\"$5\",bg:\"$bgApp\",$md:{height:130},children:_jsxs(Stack,{flex:1,$gtMd:{gap:'$2.5',flexDirection:'row',alignItems:'center',justifyContent:'space-between'},$md:{gap:'$5'},children:[_jsxs(XStack,{alignItems:\"center\",gap:\"$2\",children:[_jsx(SizableText,{size:\"$bodyMdMedium\",color:\"$text\",children:intl.formatMessage({id:ETranslations.manage_token_custom_token_create_address})}),_jsx(Icon,{name:\"ArrowRightOutline\",color:\"$iconSubdued\",size:\"$5\"}),_jsx(SizableText,{size:\"$bodyMdMedium\",color:\"$textSubdued\",children:intl.formatMessage({id:ETranslations.manage_token_custom_token_add})})]}),_jsx(AccountSelectorCreateAddressButton,{num:0,account:{walletId,indexedAccountId,networkId:selectedNetworkIdValue,deriveType},buttonRender:CreateAddressButton,onCreateDone:function(){setTimeout(function(){void runCheckAccountExist();});}})]})})})]});}function AddCustomTokenModalWithMirror(){return _jsx(AccountSelectorProviderMirror,{config:{sceneName:EAccountSelectorSceneName.home},enabledNum:[0],\"data-sentry-element\":\"AccountSelectorProviderMirror\",\"data-sentry-component\":\"AddCustomTokenModalWithMirror\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\",children:_jsx(AddCustomTokenModal,{\"data-sentry-element\":\"AddCustomTokenModal\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx\"})});}export default AddCustomTokenModalWithMirror;","import{Page}from'@onekeyhq/components';import{EDAppModalPageStatus}from'@onekeyhq/shared/types/dappConnection';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export function useDappCloseHandler(dappApprove,onClose){var handleOnClose=function(extra){if(extra?.flag!==EDAppModalPageStatus.Confirmed){dappApprove.reject();}if(typeof onClose==='function'){onClose(extra);}};return handleOnClose;}function DappOpenModalPage({children,onClose,dappApprove}){var handleOnClose=useDappCloseHandler(dappApprove,onClose);return _jsxs(Page,{scrollEnabled:true,onClose:handleOnClose,\"data-sentry-element\":\"Page\",\"data-sentry-component\":\"DappOpenModalPage\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DappOpenModalPage.tsx\",children:[_jsx(Page.Header,{headerShown:false,\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DappOpenModalPage.tsx\"}),children]});}export default DappOpenModalPage;"],"names":["useAddTokenForm","token","networkId","isAllNetwork","getDefaultNetwork","useCallback","eth","form","useForm","values","contractAddress","address","symbol","decimals","toString","mode","reValidateMode","selectedNetworkIdValue","watch","contractAddressValue","symbolValue","decimalsValue","isEmptyContract","setIsEmptyContract","useState","firstRenderRef","useRef","setIsEmptyContractState","value","current","useEffect","trigger","useAddToken","walletId","_ref2","result","availableNetworks","networkIds","serviceNetwork","getCustomTokenEnabledNetworks","currentNetworkId","map","o","id","network","getNetwork","includes","push","searchedTokenRef","fetchContractList","params","_token$isNative","trim","setValue","searchResult","serviceCustomToken","searchTokenByContractAddress","isNative","Array","isArray","length","info","firstToken","_x","apply","this","arguments","useAccountInfoForManageToken","_ref3","findAccountInfoForNetwork","accountId","isOthersWallet","indexedAccountId","deriveType","selectedNetworkId","serviceAccount","hasExistAccountFlag","accountIdForNetwork","getAccount","getNetworkAccount","undefined","e","_x2","useCheckAccountExist","checkAccountIsExist","hasExistAccount","run","runCheckAccountExist","ownKeys","r","t","Object","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","enumerable","_objectSpread","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","CreateAddressButton","props","intl","Button","$md","flexGrow","flexBasis","size","variant","children","formatMessage","ETranslations","global_create_address","AddCustomTokenModal","_$sourceInfo$id","_ref","route","routeWalletId","routeNetworkId","routeIndexedAccountId","routeAccountId","routeIsOthersWallet","routeDeriveType","routeToken","onSuccess","routeOnSuccess","$sourceInfo","dappWalletId","dappNetworkId","dappIndexedAccountId","dappAccountId","dappIsOthersWallet","dappDeriveType","dappToken","dappOnSuccess","dappApprove","closeWindowAfterResolved","vaultSettings","getVaultSettings","isLoading","setIsLoading","disabled","useMemo","isInteger","onConfirm","close","Toast","error","title","reject","getValues","manger_token_custom_token_address_required","key","send_engine_incorrect_address","_searchedTokenRef$cur","_searchedTokenRef$cur2","tokenInfo","toNumber","allNetworkAccountId","name","$key","activateToken","addCustomToken","success","address_book_add_address_toast_add_success","setTimeout","resolve","renderNetworkSelectorFormItem","_availableNetworks$ne","Form","Field","label","global_chain","global_network","Stack","userSelect","flexDirection","alignItems","borderRadius","borderWidth","borderCurve","borderColor","px","py","$gtMd","testID","SizableText","flex","handleOnClose","Page","onClose","Header","manage_token_custom_token_title","Body","isNativeTokenContractAddressEmpty","manage_token_custom_token_contract_address","rules","validate","Token_manage_custom_token_address_faild","Input","editable","manage_token_custom_token_symbol","manage_token_custom_token_decimal","Footer","onConfirmText","manage_token_custom_token_add_btn","confirmButtonProps","loading","p","bg","height","gap","justifyContent","XStack","color","manage_token_custom_token_create_address","Icon","manage_token_custom_token_add","num","account","buttonRender","onCreateDone","AddCustomTokenModalWithMirror","config","sceneName","home","enabledNum","useDappCloseHandler","extra","flag","Confirmed","DappOpenModalPage","scrollEnabled","headerShown"],"sourceRoot":""}