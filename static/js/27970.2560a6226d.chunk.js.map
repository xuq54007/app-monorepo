{"version":3,"file":"static/js/27970.2560a6226d.chunk.js","mappings":"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","sources":["webpack://web/../../packages/kit/src/views/Receive/pages/CreateInvoice.tsx"],"sourcesContent":["import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{useCallback,useMemo,useState}from'react';import{useRoute}from'@react-navigation/core';import BigNumber from'bignumber.js';import{useIntl}from'react-intl';import{Form,Input,NumberSizeableText,Page,TextArea,useForm,useMedia}from'@onekeyhq/components';import{useSettingsPersistAtom}from'@onekeyhq/kit-bg/src/states/jotai/atoms';import{ETranslations}from'@onekeyhq/shared/src/locale';import{EModalReceiveRoutes}from'@onekeyhq/shared/src/routes';import backgroundApiProxy from\"../../../background/instance/backgroundApiProxy\";import useAppNavigation from\"../../../hooks/useAppNavigation\";import{usePromiseResult}from\"../../../hooks/usePromiseResult\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CreateInvoice(){var intl=useIntl();var media=useMedia();var form=useForm();var route=useRoute();var navigation=useAppNavigation();var{accountId,networkId}=route.params;var[settings]=useSettingsPersistAtom();var{serviceLightning}=backgroundApiProxy;var[isLoading,setIsLoading]=useState(false);var amountValue=form.watch('amount');var{result:invoiceConfig}=usePromiseResult(function(){return serviceLightning.getInvoiceConfig({networkId});},[networkId,serviceLightning]);var{result}=usePromiseResult(_asyncToGenerator(function*(){var accountAddress=yield backgroundApiProxy.serviceAccount.getAccountAddressForApi({networkId,accountId});var r=yield backgroundApiProxy.serviceToken.fetchTokensDetails({accountId,networkId,contractList:[''],withFrozenBalance:false,withCheckInscription:false});var price=r[0].price;return{price};}),[networkId,accountId]);var fiatValue=useMemo(function(){var amountBN=new BigNumber(amountValue||'0');var price=new BigNumber(result?.price||'0');if(amountBN.isInteger()&&price){return amountBN.multipliedBy(price).toFixed(2);}return'0.00';},[amountValue,result?.price]);var onSubmit=useCallback(function(){var _ref2=_asyncToGenerator(function*(values){try{setIsLoading(true);var response=yield serviceLightning.createInvoice({accountId,networkId,amount:values.amount||'0',description:values.description});navigation.push(EModalReceiveRoutes.ReceiveInvoice,{networkId,accountId,paymentHash:response.payment_hash,paymentRequest:response.payment_request});}finally{setIsLoading(false);}});return function(_x){return _ref2.apply(this,arguments);};}(),[accountId,networkId,serviceLightning,navigation]);return _jsxs(Page,{\"data-sentry-element\":\"Page\",\"data-sentry-component\":\"CreateInvoice\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\",children:[_jsx(Page.Header,{title:intl.formatMessage({id:ETranslations.lighting_invoice}),\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\"}),_jsx(Page.Body,{p:\"$5\",\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\",children:_jsxs(Form,{form:form,\"data-sentry-element\":\"Form\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\",children:[_jsx(Form.Field,{label:intl.formatMessage({id:ETranslations.send_amount}),name:\"amount\",description:_jsx(NumberSizeableText,{pt:\"$1.5\",size:\"$bodyMd\",color:\"$textSubdued\",formatter:\"value\",formatterOptions:{currency:settings.currencyInfo.symbol},children:fiatValue}),rules:{min:{value:0,message:intl.formatMessage({id:ETranslations.form_lighting_invoice_error_positive_integer_only})},pattern:{value:/^[0-9]*$/,message:intl.formatMessage({id:ETranslations.form_lighting_invoice_error_positive_integer_only})},validate:function(value){if(!value)return;var valueBN=new BigNumber(value);if(!valueBN.isInteger()){return intl.formatMessage({id:ETranslations.form_lighting_invoice_error_positive_integer_only});}if(invoiceConfig?.maxReceiveAmount&&valueBN.isGreaterThan(invoiceConfig?.maxReceiveAmount)){return intl.formatMessage({id:ETranslations.form_lighting_invoice_amount_error_max},{amount:invoiceConfig?.maxReceiveAmount});}}},\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\",children:_jsx(Input,{placeholder:intl.formatMessage({id:ETranslations.form_amount_placeholder}),size:\"large\",$gtMd:{size:'medium'},keyboardType:\"number-pad\",addOns:[{label:'sats'}],\"data-sentry-element\":\"Input\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\"})}),_jsx(Form.Field,{label:intl.formatMessage({id:ETranslations.global_description}),name:\"description\",rules:{maxLength:{value:40,message:intl.formatMessage({id:ETranslations.dapp_connect_msg_description_can_be_up_to_int_characters},{number:'40'})}},\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\",children:_jsx(TextArea,{size:media.gtMd?'medium':'large',$gtMd:{size:'medium'},placeholder:intl.formatMessage({id:ETranslations.form_lighting_invoice_placeholder}),\"data-sentry-element\":\"TextArea\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\"})})]})}),_jsx(Page.Footer,{onConfirmText:intl.formatMessage({id:ETranslations.global_create_invoice}),onConfirm:function(){return form.handleSubmit(onSubmit)();},confirmButtonProps:{loading:isLoading},\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Receive/pages/CreateInvoice.tsx\"})]});}export default CreateInvoice;"],"names":["CreateInvoice","_ref2","intl","media","useMedia","form","useForm","route","navigation","accountId","networkId","params","settings","useSettingsPersistAtom","serviceLightning","isLoading","setIsLoading","useState","amountValue","watch","result","invoiceConfig","getInvoiceConfig","serviceAccount","getAccountAddressForApi","price","serviceToken","fetchTokensDetails","contractList","withFrozenBalance","withCheckInscription","fiatValue","useMemo","amountBN","isInteger","multipliedBy","toFixed","onSubmit","useCallback","values","response","createInvoice","amount","description","push","ReceiveInvoice","paymentHash","payment_hash","paymentRequest","payment_request","_x","apply","this","arguments","Page","children","Header","title","formatMessage","id","ETranslations","lighting_invoice","Body","p","Form","Field","label","send_amount","name","NumberSizeableText","pt","size","color","formatter","formatterOptions","currency","currencyInfo","symbol","rules","min","value","message","form_lighting_invoice_error_positive_integer_only","pattern","validate","valueBN","maxReceiveAmount","isGreaterThan","form_lighting_invoice_amount_error_max","Input","placeholder","form_amount_placeholder","$gtMd","keyboardType","addOns","global_description","maxLength","dapp_connect_msg_description_can_be_up_to_int_characters","number","TextArea","gtMd","form_lighting_invoice_placeholder","Footer","onConfirmText","global_create_invoice","onConfirm","handleSubmit","confirmButtonProps","loading"],"sourceRoot":""}