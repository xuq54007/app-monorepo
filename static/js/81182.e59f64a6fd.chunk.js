!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="614a1d1b-5d7a-4e50-8c6a-98bbc9d95664",e._sentryDebugIdIdentifier="sentry-dbid-614a1d1b-5d7a-4e50-8c6a-98bbc9d95664")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.5.0 (2024121652)"},(self.webpackChunkweb=self.webpackChunkweb||[]).push([[81182],{424403:(e,t,o)=>{o.d(t,{KR:()=>useCheckAccountExist,Mo:()=>useAccountInfoForManageToken,YF:()=>useAddToken,yT:()=>useAddTokenForm});var n=o(586330),r=o(514041),s=o(241440),a=o(578104),d=o(490343),c=o(625931),i=o(553083),l=o(643087),u=o(911998);function useAddTokenForm({token:e,networkId:t}){var o=i.Ay.isAllNetwork({networkId:t}),n=(0,r.useCallback)((function(){return e&&e.networkId?e.networkId:o?(0,c.V)().eth:t}),[o,t,e]),a=(0,d.useForm)({values:{networkId:n(),contractAddress:e?.address||"",symbol:e?.symbol||"",decimals:e?.decimals?new s.A(e.decimals).toString():""},mode:"onChange",reValidateMode:"onBlur"}),l=a.watch("networkId"),u=a.watch("contractAddress"),p=a.watch("symbol"),m=a.watch("decimals"),[k,w]=(0,r.useState)(!1),f=(0,r.useRef)(!0),g=(0,r.useCallback)((function(t){f.current||(e?.address||u)&&w(t)}),[u,e?.address]);return(0,r.useEffect)((function(){f.current?f.current=!1:a.trigger("contractAddress")}),[k,a]),{form:a,isEmptyContract:k,setIsEmptyContractState:g,selectedNetworkIdValue:l,contractAddressValue:u,symbolValue:p,decimalsValue:m}}function useAddToken({token:e,walletId:t,networkId:o,form:d,selectedNetworkIdValue:c,contractAddressValue:i,setIsEmptyContractState:p}){var m,{result:k}=(0,u.yk)((0,n.A)((function*(){var t=(yield l.A.serviceNetwork.getCustomTokenEnabledNetworks({currentNetworkId:o})).map((function(e){return e.id})),n=yield l.A.serviceNetwork.getNetwork({networkId:o});return e?.networkId&&!t.includes(e.networkId)&&t.push(e.networkId),{networkIds:t,network:n}})),[o,e?.networkId]),w=(0,r.useRef)(),f=(0,a.YQ)((m=(0,n.A)((function*(o){var n;if(!e&&!o.value.trim())return d.setValue("symbol",""),d.setValue("decimals",""),void p(!0);var r=yield l.A.serviceCustomToken.searchTokenByContractAddress({walletId:t,networkId:o.networkId,contractAddress:o.value.trim(),isNative:null!=(n=e?.isNative)&&n});if(Array.isArray(r)&&r.length>0&&r[0]?.info){var[a]=r;d.setValue("symbol",a.info.symbol),d.setValue("decimals",new s.A(a.info.decimals).toString()),w.current=a.info,p(!1)}else d.setValue("symbol",""),d.setValue("decimals",""),p(!0)})),function(e){return m.apply(this,arguments)}),300);return(0,r.useEffect)((function(){f({value:i,networkId:c})}),[i,c,f]),{availableNetworks:k,searchedTokenRef:w}}function useAccountInfoForManageToken(){var e,t=(0,r.useCallback)((e=(0,n.A)((function*({accountId:e,networkId:t,isOthersWallet:o,indexedAccountId:n,deriveType:r,selectedNetworkId:s}){var{serviceAccount:a}=l.A,d=!1,c="";try{c=o?(yield a.getAccount({accountId:e,networkId:t})).id:(yield a.getNetworkAccount({accountId:void 0,indexedAccountId:n,networkId:s,deriveType:r})).id,d=!0}catch(e){d=!1}return{hasExistAccountFlag:d,accountIdForNetwork:c}})),function(t){return e.apply(this,arguments)}),[]);return{findAccountInfoForNetwork:t}}function useCheckAccountExist({accountId:e,networkId:t,isOthersWallet:o,indexedAccountId:s,deriveType:a,selectedNetworkIdValue:d}){var{findAccountInfoForNetwork:c}=useAccountInfoForManageToken(),i=(0,r.useCallback)((0,n.A)((function*(){return c({accountId:e,networkId:t,isOthersWallet:o,indexedAccountId:s,deriveType:a,selectedNetworkId:d})})),[e,s,t,o,a,d,c]),{result:l,run:p}=(0,u.yk)((0,n.A)((function*(){var{hasExistAccountFlag:e}=yield i();return e})),[i]);return{hasExistAccount:l,runCheckAccountExist:p,checkAccountIsExist:i}}},281182:(e,t,o)=>{o.r(t),o.d(t,{default:()=>x});var n=o(586330),r=o(324586),s=o(514041),a=o(654266),d=o(241440),c=o(908867),i=o(490343),l=o(325809),u=o(525603),p=o(796895),m=o(24284),k=o(507140),w=o(334439),f=o(553083),g=o(714191),y=o(643087),A=o(414375),I=o(911998),b=o(980342),h=o(424403),v=o(831085);function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(o),!0).forEach((function(t){(0,r.A)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function CreateAddressButton(e){var t=(0,c.A)();return(0,v.jsx)(i.Button,_objectSpread(_objectSpread({$md:{flexGrow:1,flexBasis:0,size:"large"},variant:"primary"},e),{},{"data-sentry-element":"Button","data-sentry-component":"CreateAddressButton","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:t.formatMessage({id:w.ETranslations.global_create_address})}))}function AddCustomTokenModal(){var e,t,o=(0,c.A)(),r=(0,a.lq)(),{walletId:g,networkId:x,indexedAccountId:_,accountId:T,isOthersWallet:C,deriveType:M,token:j,onSuccess:E}=r.params,{$sourceInfo:N,walletId:S,networkId:$,indexedAccountId:F,accountId:O,isOthersWallet:V,deriveType:D,token:P,onSuccess:z}=(0,m.A)(),L=(0,p.A)({id:null!=(e=N?.id)?e:"",closeWindowAfterResolved:!0}),R=null!=S?S:g,B=null!=$?$:x,W=null!=F?F:_,H=null!=O?O:T,K=null!=V?V:C,Y=null!=D?D:M,q=null!=P?P:j,Z=null!=z?z:E,G=f.Ay.isAllNetwork({networkId:B}),{form:J,isEmptyContract:Q,setIsEmptyContractState:X,selectedNetworkIdValue:U,contractAddressValue:ee,symbolValue:te,decimalsValue:oe}=(0,h.yT)({token:q,networkId:B}),{hasExistAccount:ne,runCheckAccountExist:re,checkAccountIsExist:se}=(0,h.KR)({accountId:H,networkId:B,isOthersWallet:K,indexedAccountId:W,deriveType:Y,selectedNetworkIdValue:U}),{availableNetworks:ae,searchedTokenRef:de}=(0,h.YF)({token:q,walletId:R,networkId:B,form:J,selectedNetworkIdValue:U,contractAddressValue:ee,setIsEmptyContractState:X,checkAccountIsExist:se}),{result:ce}=(0,I.yk)((function(){return y.A.serviceNetwork.getVaultSettings({networkId:U})}),[U]),[ie,le]=(0,s.useState)(!1),ue=(0,s.useMemo)((function(){return!ne||(!!Q||(!te||!new d.A(oe).isInteger()||!!ie))}),[te,oe,Q,ie,ne]),pe=(0,s.useCallback)((t=(0,n.A)((function*(e){le(!0);var{hasExistAccountFlag:t,accountIdForNetwork:n}=yield se();if(!t)return i.Toast.error({title:"Account not exist"}),void L.reject();var r=J.getValues(),{contractAddress:s,symbol:a,decimals:c}=r;if(!s&&!q?.isNative)return le(!1),i.Toast.error({title:o.formatMessage({id:w.ETranslations.manger_token_custom_token_address_required})}),void L.reject({error:new k.oZ({key:w.ETranslations.manger_token_custom_token_address_required})});if(!a||!new d.A(c).isInteger())return le(!1),i.Toast.error({title:o.formatMessage({id:w.ETranslations.send_engine_incorrect_address})}),void L.reject({error:new k.oZ({key:w.ETranslations.send_engine_incorrect_address})});try{var l,u,p=_objectSpread(_objectSpread({address:s,symbol:a,decimals:new d.A(c).toNumber()},de.current),{},{accountId:n,networkId:U,allNetworkAccountId:G?H:void 0,name:null!=(l=de.current?.name)?l:"",isNative:null!=(u=de.current?.isNative)&&u,$key:`${U}_${s}`});yield y.A.serviceCustomToken.activateToken({accountId:n,networkId:U,token:p}),yield y.A.serviceCustomToken.addCustomToken({token:p})}finally{le(!1)}i.Toast.success({title:o.formatMessage({id:w.ETranslations.address_book_add_address_toast_add_success})}),setTimeout((function(){L.resolve(),Z?.(),e?.()}),300)})),function(e){return t.apply(this,arguments)}),[J,se,U,q?.isNative,o,Z,G,H,de,L]),me=(0,s.useCallback)((function(){var e;return G?(0,v.jsx)(i.Form.Field,{label:o.formatMessage({id:w.ETranslations.global_chain}),name:"networkId",children:(0,v.jsx)(l.YS,{networkIds:ae?.networkIds})}):(0,v.jsx)(i.Form.Field,{label:o.formatMessage({id:w.ETranslations.global_network}),name:"networkId",children:(0,v.jsxs)(i.Stack,{userSelect:"none",flexDirection:"row",alignItems:"center",borderRadius:"$3",borderWidth:1,borderCurve:"continuous",borderColor:"$borderStrong",px:"$3",py:"$2.5",$gtMd:{borderRadius:"$2",py:"$2"},testID:"network-selector-input",children:[(0,v.jsx)(A.um,{networkId:B,size:"$6"}),(0,v.jsx)(i.SizableText,{testID:"network-selector-input-text",px:14,flex:1,size:"$bodyLg",children:null!=(e=ae?.network.name)?e:""})]})})}),[ae,o,G,B]),ke=(0,b.z)(L);return(0,v.jsxs)(i.Page,{onClose:ke,"data-sentry-element":"Page","data-sentry-component":"AddCustomTokenModal","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:[(0,v.jsx)(i.Page.Header,{title:o.formatMessage({id:w.ETranslations.manage_token_custom_token_title}),"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx"}),(0,v.jsx)(i.Page.Body,{px:"$5","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:(0,v.jsxs)(i.Form,{form:J,"data-sentry-element":"Form","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:[me(),ce?.isNativeTokenContractAddressEmpty?null:(0,v.jsx)(i.Form.Field,{label:o.formatMessage({id:w.ETranslations.manage_token_custom_token_contract_address}),rules:{validate:function(){if(Q)return o.formatMessage({id:w.ETranslations.Token_manage_custom_token_address_faild})}},name:"contractAddress",children:(0,v.jsx)(i.Input,{size:"large",$gtMd:{size:"medium"},editable:!q?.isNative})}),(0,v.jsx)(i.Form.Field,{label:o.formatMessage({id:w.ETranslations.manage_token_custom_token_symbol}),name:"symbol","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:(0,v.jsx)(i.Input,{size:"large",$gtMd:{size:"medium"},editable:!1,"data-sentry-element":"Input","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx"})}),(0,v.jsx)(i.Form.Field,{label:o.formatMessage({id:w.ETranslations.manage_token_custom_token_decimal}),name:"decimals","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:(0,v.jsx)(i.Input,{size:"large",$gtMd:{size:"medium"},editable:!1,"data-sentry-element":"Input","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx"})})]})}),(0,v.jsx)(i.Page.Footer,{onConfirmText:o.formatMessage({id:w.ETranslations.manage_token_custom_token_add_btn}),onConfirm:pe,confirmButtonProps:{loading:ie,disabled:ue},"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:ne?void 0:(0,v.jsx)(i.Stack,{testID:"add-custom-token-modal-footer",p:"$5",bg:"$bgApp",$md:{height:130},children:(0,v.jsxs)(i.Stack,{flex:1,$gtMd:{gap:"$2.5",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},$md:{gap:"$5"},children:[(0,v.jsxs)(i.XStack,{alignItems:"center",gap:"$2",children:[(0,v.jsx)(i.SizableText,{size:"$bodyMdMedium",color:"$text",children:o.formatMessage({id:w.ETranslations.manage_token_custom_token_create_address})}),(0,v.jsx)(i.Icon,{name:"ArrowRightOutline",color:"$iconSubdued",size:"$5"}),(0,v.jsx)(i.SizableText,{size:"$bodyMdMedium",color:"$textSubdued",children:o.formatMessage({id:w.ETranslations.manage_token_custom_token_add})})]}),(0,v.jsx)(u.J,{num:0,account:{walletId:R,indexedAccountId:W,networkId:U,deriveType:Y},buttonRender:CreateAddressButton,onCreateDone:function(){setTimeout((function(){re()}))}})]})})})]})}const x=function AddCustomTokenModalWithMirror(){return(0,v.jsx)(l.b8,{config:{sceneName:g.Zs.home},enabledNum:[0],"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"AddCustomTokenModalWithMirror","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:(0,v.jsx)(AddCustomTokenModal,{"data-sentry-element":"AddCustomTokenModal","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx"})})}},980342:(e,t,o)=>{o.d(t,{A:()=>a,z:()=>useDappCloseHandler});var n=o(490343),r=o(42484),s=o(831085);function useDappCloseHandler(e,t){return function(o){o?.flag!==r.nd.Confirmed&&e.reject(),"function"==typeof t&&t(o)}}const a=function DappOpenModalPage({children:e,onClose:t,dappApprove:o}){var r=useDappCloseHandler(o,t);return(0,s.jsxs)(n.Page,{scrollEnabled:!0,onClose:r,"data-sentry-element":"Page","data-sentry-component":"DappOpenModalPage","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DappOpenModalPage.tsx",children:[(0,s.jsx)(n.Page.Header,{headerShown:!1,"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DappOpenModalPage.tsx"}),e]})}}}]);
//# sourceMappingURL=81182.e59f64a6fd.chunk.js.map