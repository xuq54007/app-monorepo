{"version":3,"file":"static/js/98481.574f618e30.chunk.js","mappings":"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","sources":["webpack://web/../../packages/kit/src/views/DAppConnection/components/DAppConnectExtensionFloatingTrigger/index.tsx","webpack://web/../../packages/kit/src/views/Notifications/components/NotificationRegisterDaily.tsx","webpack://web/../../packages/kit/src/views/Home/pages/HomePageContainer.tsx","webpack://web/../../packages/kit/src/views/Onboarding/components/OnboardingOnMount.tsx"],"sourcesContent":["export default function DAppConnectExtensionFloatingTrigger(){return null;}","import _noop from\"lodash/noop\";import{useEffect,useRef}from'react';import{useSettingsPersistAtom,useSettingsValuePersistAtom}from'@onekeyhq/kit-bg/src/states/jotai/atoms';import backgroundApiProxy from\"../../../background/instance/backgroundApiProxy\";import{useRouteIsFocused}from\"../../../hooks/useRouteIsFocused\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";export function NotificationRegisterDaily(){var isFocused=useRouteIsFocused();var[{locale,currencyInfo}]=useSettingsPersistAtom();var[{hideValue}]=useSettingsValuePersistAtom();var isFirstRender=useRef(true);useEffect(function(){if(isFirstRender.current){return;}if(isFocused){void backgroundApiProxy.serviceNotification.registerClientDaily();}},[isFocused]);useEffect(function(){if(isFirstRender.current){isFirstRender.current=false;return;}_noop(locale,currencyInfo,hideValue);void backgroundApiProxy.serviceNotification.updateClientBasicAppInfo();},[locale,currencyInfo,hideValue]);return _jsx(_Fragment,{});}","import{useState}from'react';import DAppConnectExtensionFloatingTrigger from'@onekeyhq/kit/src/views/DAppConnection/components/DAppConnectExtensionFloatingTrigger';import{useDebugComponentRemountLog}from'@onekeyhq/shared/src/utils/debug/debugUtils';import{EAccountSelectorSceneName}from'@onekeyhq/shared/types';import{AccountSelectorProviderMirror}from\"../../../components/AccountSelector\";import{withAccountOverviewProvider}from\"../../../states/jotai/contexts/accountOverview\";import{useActiveAccount,useSelectedAccount,useSelectedAccountsAtom}from\"../../../states/jotai/contexts/accountSelector\";import{NotificationRegisterDaily}from\"../../Notifications/components/NotificationRegisterDaily\";import{OnboardingOnMount}from\"../../Onboarding/components\";import{HomePageView}from\"./HomePageView\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EmptyRenderTest(){return null;}function ActiveAccountTest(){var{activeAccount}=useActiveAccount({num:0});return null;}function SelectedAccountTest(){var{selectedAccount}=useSelectedAccount({num:0,debugName:'HomePage'});return null;}function SelectedAccountsMapTest(){var[selectedAccounts]=useSelectedAccountsAtom();return null;}function HomePageContainer(){var[isHide,setIsHide]=useState(false);useDebugComponentRemountLog({name:'HomePageContainer'});if(isHide){return null;}var sceneName=EAccountSelectorSceneName.home;return _jsxs(AccountSelectorProviderMirror,{config:{sceneName,sceneUrl:''},enabledNum:[0],\"data-sentry-element\":\"AccountSelectorProviderMirror\",\"data-sentry-component\":\"HomePageContainer\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomePageContainer.tsx\",children:[_jsx(HomePageView,{sceneName:sceneName,onPressHide:function(){return setIsHide(function(v){return!v;});},\"data-sentry-element\":\"HomePageView\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomePageContainer.tsx\"},sceneName),_jsx(DAppConnectExtensionFloatingTrigger,{\"data-sentry-element\":\"DAppConnectExtensionFloatingTrigger\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomePageContainer.tsx\"}),_jsx(OnboardingOnMount,{\"data-sentry-element\":\"OnboardingOnMount\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomePageContainer.tsx\"}),_jsx(NotificationRegisterDaily,{\"data-sentry-element\":\"NotificationRegisterDaily\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomePageContainer.tsx\"}),\"production\"!=='production'?_jsxs(_Fragment,{children:[_jsx(SelectedAccountsMapTest,{}),_jsx(SelectedAccountTest,{}),_jsx(ActiveAccountTest,{}),_jsx(EmptyRenderTest,{})]}):null]});}export default withAccountOverviewProvider(HomePageContainer);","import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{memo,useCallback,useEffect,useRef,useState}from'react';import{useIntl}from'react-intl';import{Checkbox,Dialog,YStack}from'@onekeyhq/components';import{useV4migrationPersistAtom}from'@onekeyhq/kit-bg/src/states/jotai/atoms';import{EAppEventBusNames,appEventBus}from'@onekeyhq/shared/src/eventBus/appEventBus';import{ETranslations}from'@onekeyhq/shared/src/locale';import platformEnv from'@onekeyhq/shared/src/platformEnv';import timerUtils from'@onekeyhq/shared/src/utils/timerUtils';import backgroundApiProxy from\"../../../background/instance/backgroundApiProxy\";import useAppNavigation from\"../../../hooks/useAppNavigation\";import{openOnBoardingFromExt,useToOnBoardingPage}from\"../pages\";import{useV4MigrationActions}from\"../pages/V4Migration/hooks/useV4MigrationActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var lastAutoStartV4MigrationTime=0;var isBaseSettingsMigrated=false;var downgradeConfirmDialogShown=false;var isAutoStartV4MigrationShown=false;function DowngradeWarningDialogContent({onConfirm}){var intl=useIntl();var[checkState,setCheckState]=useState(false);var handleConfirm=useCallback(function(){return new Promise(function(resolve){setTimeout(function(){onConfirm(checkState);resolve();},0);});},[checkState,onConfirm]);return _jsxs(YStack,{\"data-sentry-element\":\"YStack\",\"data-sentry-component\":\"DowngradeWarningDialogContent\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/components/OnboardingOnMount.tsx\",children:[_jsx(Dialog.Title,{\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/components/OnboardingOnMount.tsx\",children:intl.formatMessage({id:ETranslations.downgrade_warning_title})}),_jsx(Dialog.Description,{\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/components/OnboardingOnMount.tsx\",children:intl.formatMessage({id:ETranslations.downgrade_warning_description})}),_jsx(Checkbox,{value:checkState,label:intl.formatMessage({id:ETranslations.downgrade_warning_checkbox_label}),onChange:setCheckState,\"data-sentry-element\":\"Checkbox\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/components/OnboardingOnMount.tsx\"}),_jsx(Dialog.Footer,{confirmButtonProps:{disabled:!checkState},onConfirm:handleConfirm,onConfirmText:intl.formatMessage({id:ETranslations.global_i_understand}),showCancelButton:false,\"data-sentry-element\":\"unknown\",\"data-sentry-source-file\":\"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Onboarding/components/OnboardingOnMount.tsx\"})]});}function OnboardingOnMountCmp(){var toOnBoardingPage=useToOnBoardingPage();var navigation=useAppNavigation();var v4migrationActions=useV4MigrationActions();var[v4migrationPersistData,setV4MigrationPersistAtom]=useV4migrationPersistAtom();var downgradeWarningConfirmed=v4migrationPersistData?.downgradeWarningConfirmed;var downgradeWarningConfirmedRef=useRef(downgradeWarningConfirmed);downgradeWarningConfirmedRef.current=downgradeWarningConfirmed;var migrateBaseSettings=useCallback(_asyncToGenerator(function*(){var shouldMigrateFromV4=yield backgroundApiProxy.serviceV4Migration.checkShouldMigrateV4OnMount();if(shouldMigrateFromV4){if(!isBaseSettingsMigrated){isBaseSettingsMigrated=true;yield backgroundApiProxy.serviceV4Migration.migrateBaseSettings();}}}),[]);var checkOnboardingState=useCallback(_asyncToGenerator(function*({checkingV4Migration}={}){try{if(checkingV4Migration){var shouldMigrateFromV4=yield backgroundApiProxy.serviceV4Migration.checkShouldMigrateV4OnMount();if(shouldMigrateFromV4){yield migrateBaseSettings();yield timerUtils.wait(600);if(!isAutoStartV4MigrationShown){isAutoStartV4MigrationShown=true;yield v4migrationActions.navigateToV4MigrationPage({isAutoStartOnMount:true});var now=Date.now();if(now-lastAutoStartV4MigrationTime>3000){lastAutoStartV4MigrationTime=now;setV4MigrationPersistAtom(function(v){return _objectSpread(_objectSpread({},v),{},{v4migrationAutoStartCount:(v.v4migrationAutoStartCount||0)+1});});}}return;}}}catch(error){}if(openOnBoardingFromExt()){return;}var{isOnboardingDone}=yield backgroundApiProxy.serviceOnboarding.isOnboardingDone();if(!isOnboardingDone&&!platformEnv.isWebDappMode){void toOnBoardingPage({isFullModal:true});}}),[migrateBaseSettings,setV4MigrationPersistAtom,toOnBoardingPage,v4migrationActions]);var checkStateOnMount=useCallback(_asyncToGenerator(function*(){if(false&&!downgradeWarningConfirmedRef.current){var isV4DbExist=yield backgroundApiProxy.serviceV4Migration.checkIfV4DbExist();if(isV4DbExist&&!downgradeConfirmDialogShown){downgradeConfirmDialogShown=true;downgradeWarningConfirmedRef.current=true;yield migrateBaseSettings();yield timerUtils.wait(600);var dialog=Dialog.show({tone:'warning',icon:'ShieldCheckDoneOutline',showExitButton:false,showCancelButton:false,dismissOnOverlayPress:false,renderContent:_jsx(DowngradeWarningDialogContent,{onConfirm:function(){setV4MigrationPersistAtom(function(v){return _objectSpread(_objectSpread({},v),{},{downgradeWarningConfirmed:true});});void checkOnboardingState({checkingV4Migration:true});void dialog.close();}})});return;}}yield checkOnboardingState({checkingV4Migration:true});}),[checkOnboardingState,migrateBaseSettings,setV4MigrationPersistAtom]);useEffect(function(){},[]);useEffect(function(){},[setV4MigrationPersistAtom]);useEffect(function(){},[navigation]);useEffect(function(){},[v4migrationActions]);useEffect(function(){void checkStateOnMount();},[checkStateOnMount]);useEffect(function(){var fn=function(){void checkOnboardingState({checkingV4Migration:false});};appEventBus.on(EAppEventBusNames.WalletClear,fn);return function(){appEventBus.off(EAppEventBusNames.WalletClear,fn);};},[checkOnboardingState]);return null;}export var OnboardingOnMount=memo(OnboardingOnMountCmp);"],"names":["DAppConnectExtensionFloatingTrigger","NotificationRegisterDaily","isFocused","useRouteIsFocused","locale","currencyInfo","useSettingsPersistAtom","hideValue","useSettingsValuePersistAtom","isFirstRender","useRef","useEffect","current","backgroundApiProxy","serviceNotification","registerClientDaily","updateClientBasicAppInfo","HomePageContainer","isHide","setIsHide","useState","name","sceneName","home","AccountSelector","config","sceneUrl","enabledNum","children","HomePageView","onPressHide","v","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","lastAutoStartV4MigrationTime","isBaseSettingsMigrated","isAutoStartV4MigrationShown","OnboardingOnMount","memo","OnboardingOnMountCmp","toOnBoardingPage","navigation","v4migrationActions","useV4MigrationActions","v4migrationPersistData","setV4MigrationPersistAtom","useV4migrationPersistAtom","downgradeWarningConfirmed","migrateBaseSettings","useCallback","serviceV4Migration","checkShouldMigrateV4OnMount","checkOnboardingState","checkingV4Migration","timerUtils","wait","navigateToV4MigrationPage","isAutoStartOnMount","now","Date","v4migrationAutoStartCount","error","isOnboardingDone","serviceOnboarding","platformEnv","isWebDappMode","isFullModal","checkStateOnMount","fn","appEventBus","on","WalletClear","off"],"sourceRoot":""}