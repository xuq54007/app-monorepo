!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f22562b6-ce1a-486d-bf58-37b843270317",e._sentryDebugIdIdentifier="sentry-dbid-f22562b6-ce1a-486d-bf58-37b843270317")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.5.0 (2024121652)"},(self.webpackChunkweb=self.webpackChunkweb||[]).push([[52320],{593827:(e,t,n)=>{n.d(t,{L:()=>WalletAvatar});var o=n(503668),a=n.n(o),i=n(490343),r=n(491180),c=n(258988),s=n(831085);function WalletAvatarBase({size:e,img:t,wallet:n}){var o,a,l=t||n?.avatarInfo?.img;return l?r.A.isHwHiddenWallet({wallet:n})?(0,s.jsx)(i.Icon,{size:"$10",name:"LockSolid",color:"$iconSubdued"}):(0,s.jsxs)(i.Image,{size:e,"data-sentry-element":"Image","data-sentry-component":"WalletAvatarBase","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/WalletAvatar/WalletAvatar.tsx",children:[(0,s.jsx)(i.Image.Source,{source:null!=(o=c.UO[l])?o:c.UO.bear,"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/WalletAvatar/WalletAvatar.tsx"}),(0,s.jsx)(i.Image.Fallback,{delayMs:300,justifyContent:"center",alignItems:"center","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/WalletAvatar/WalletAvatar.tsx",children:(0,s.jsx)(i.SizableText,{"data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/WalletAvatar/WalletAvatar.tsx",children:null!=(a=n?.avatarInfo?.emoji)?a:""})})]}):null}function WalletAvatar({size:e="$10",status:t,badge:n,img:o,wallet:r}){return(0,s.jsxs)(i.Stack,{w:e,h:e,justifyContent:"center",alignItems:"center","data-sentry-element":"Stack","data-sentry-component":"WalletAvatar","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/WalletAvatar/WalletAvatar.tsx",children:[(0,s.jsx)(WalletAvatarBase,{size:e,img:o,wallet:r,"data-sentry-element":"WalletAvatarBase","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/WalletAvatar/WalletAvatar.tsx"}),"connected"===t?(0,s.jsx)(i.Stack,{position:"absolute",bottom:-2,right:-2,bg:"$bgSidebar",p:"$0.5",borderRadius:"$full",zIndex:"$1",children:(0,s.jsx)(i.Stack,{borderRadius:"$full",w:"$2.5",h:"$2.5",bg:"$bgSuccessStrong"})}):null,a()(n)?null:(0,s.jsx)(i.Stack,{position:"absolute",h:"$4",px:"$0.5",justifyContent:"center",bottom:-2,right:-1,bg:"$bgSubdued",borderRadius:"$full",zIndex:"$1",children:(0,s.jsx)(i.SizableText,{size:"$bodySm",textAlign:"center",children:n})})]})}},702554:(e,t,n)=>{n.d(t,{pC:()=>EmptyNoWalletView,rk:()=>EmptyView,wB:()=>EmptyNoAccountsView});var o=n(908867),a=n(490343),i=n(791088),r=n(131397),c=n(471169),s=n(334439),l=n(831085);function LoadingSkeletonView(){return(0,l.jsx)(a.Stack,{"data-sentry-element":"Stack","data-sentry-component":"LoadingSkeletonView","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AccountManagerStacks/pages/AccountSelectorStack/WalletDetails/EmptyView.tsx",children:[1,2,3].map((function(e){return(0,l.jsxs)(i.c,{children:[(0,l.jsx)(a.Stack,{children:(0,l.jsx)(a.Skeleton,{w:"$10",h:"$10"})}),(0,l.jsxs)(a.Stack,{children:[(0,l.jsx)(a.Stack,{py:"$1",children:(0,l.jsx)(a.Skeleton,{h:"$4",w:"$32"})}),(0,l.jsx)(a.Stack,{py:"$1",children:(0,l.jsx)(a.Skeleton,{h:"$3",w:"$24"})})]})]},e)}))})}function EmptyNoAccountsView({section:e}){return 0===e.data.length&&e.emptyText?(0,l.jsx)(i.c,{title:e.emptyText,titleProps:{size:"$bodyLg",textAlign:"left",py:"$2"}}):null}function EmptyNoWalletView(){var e=(0,r.t1)(),t=(0,o.A)();return(0,l.jsx)(a.Empty,{mt:"$24",icon:"WalletOutline",title:t.formatMessage({id:s.ETranslations.global_no_wallet}),description:t.formatMessage({id:s.ETranslations.global_no_wallet_desc}),buttonProps:{children:t.formatMessage({id:s.ETranslations.global_create_wallet}),onPress:function(){e({params:{showCloseButton:!0}})}},"data-sentry-element":"Empty","data-sentry-component":"EmptyNoWalletView","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AccountManagerStacks/pages/AccountSelectorStack/WalletDetails/EmptyView.tsx"})}function EmptyView(){var[e]=(0,c.useAccountSelectorAccountsListIsLoadingAtom)();return e?(0,l.jsx)(LoadingSkeletonView,{}):(0,l.jsx)(EmptyNoWalletView,{})}},352320:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var o=n(324586),a=n(446108),i=n.n(a),r=n(586330),c=n(514041),s=n(908867),l=n(17617),u=n(490343),d=n(643087),p=n(287121),g=n(593827),m=n(911998),f=n(829209),A=n(195473),y=n(334439),b=n(491180),w=n(702554),v=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=(0,c.createContext)(void 0);function isWalletEnabledFn({settings:e,wallet:t}){var n;return null!=(n=e?.[t.id]?.enabled)?n:f.EA}function isAccountEnabledFn({settings:e,account:t,wallet:n}){var o;return isWalletEnabledFn({settings:e,wallet:n})&&(null!=(o=e?.[n.id]?.accounts?.[t.id]?.enabled)?o:f.EA)}function AccountNotificationSettingsProvider({children:e,wallets:t}){var[n,o]=(0,c.useState)(),[{maxAccountCount:a=f.zH}]=(0,A.n5)(),i=(0,c.useCallback)((function(e){o((function(t){var n=e(t);return d.A.serviceNotification.saveAccountActivityNotificationSettings(n),n}))}),[]),s=(0,c.useCallback)((0,r.A)((function*(){n&&(yield d.A.serviceNotification.saveAccountActivityNotificationSettings(n))})),[n]),l=(0,c.useCallback)((function(e){var t,o;return(null!=(t=null!=(o=e?.dbAccounts)?o:e?.dbIndexedAccounts)?t:[])?.reduce((function(t,o){return isAccountEnabledFn({settings:n,account:o,wallet:e})?t+1:t}),0)}),[n]),u=(0,c.useMemo)((function(){var e=0;return t.forEach((function(t){e+=l(t),t.hiddenWallets?.length&&t.hiddenWallets.forEach((function(t){e+=l(t)}))})),e}),[t,l]),p=(0,c.useMemo)((function(){return{settings:n,saveSettings:i,commitSettings:s,totalEnabledAccountsCount:u,maxAccountCount:a}}),[n,i,s,u,a]);return(0,c.useEffect)((function(){(0,r.A)((function*(){var e=yield d.A.simpleDb.notificationSettings.getRawData();e&&o(e.accountActivity)}))()}),[]),(0,v.jsx)(k.Provider,{value:p,"data-sentry-element":"unknown","data-sentry-component":"AccountNotificationSettingsProvider","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:e})}function useContextAccountNotificationSettings(){var e=(0,c.useContext)(k);if(void 0===e)throw new Error("useAccountNotificationSettings must be used within a NotificationSettingsProvider");return e}var x=(0,c.memo)((function AccountAccordionItem({account:e,isAccountEnabled:t,isOthersWallet:n,toggleAccountSwitch:o}){return(0,v.jsxs)(u.XStack,{gap:"$3",alignItems:"center",pl:56,pr:"$5",py:"$2","data-sentry-element":"XStack","data-sentry-component":"AccountAccordionItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:[(0,v.jsx)(p.h,{dbAccount:n?e:void 0,indexedAccount:n?void 0:e,"data-sentry-element":"AccountAvatar","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx"}),(0,v.jsx)(u.SizableText,{flex:1,size:"$bodyLgMedium","data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:e.name}),(0,v.jsx)(u.Switch,{size:"small",value:t,onChange:function(t){return o(t,e)},"data-sentry-element":"Switch","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx"})]},e.id)}));function AccountAccordionItemContainer({account:e,wallet:t,isOthersWallet:n}){var o=(0,s.A)(),{settings:a,saveSettings:r,totalEnabledAccountsCount:l,maxAccountCount:d}=useContextAccountNotificationSettings(),p=(0,c.useRef)(l);p.current=l;var g=(0,c.useMemo)((function(){return isAccountEnabledFn({settings:a,account:e,wallet:t})}),[a,e,t]),m=(0,c.useCallback)((function(e,n){r((function(a){var r=i()(_objectSpread({},null!=a?a:{})),c=e;return c&&p.current>=d?(u.Dialog.confirm({title:o.formatMessage({id:y.ETranslations.notifications_account_reached_limit_dialog_title}),description:o.formatMessage({id:y.ETranslations.notifications_account_reached_limit_dialog_desc},{maxAccountCount:d}),onConfirmText:o.formatMessage({id:y.ETranslations.global_got_it})}),r):(r[t.id]=_objectSpread(_objectSpread({},r?.[t.id]),{},{accounts:_objectSpread(_objectSpread({},r?.[t.id]?.accounts),{},{[n.id]:{enabled:c}})}),r)}))}),[o,d,r,t.id]);return(0,v.jsx)(x,{account:e,isAccountEnabled:g,isOthersWallet:n,toggleAccountSwitch:m,"data-sentry-element":"AccountAccordionItemMemo","data-sentry-component":"AccountAccordionItemContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx"})}var h=(0,c.memo)((function WalletAccordionItem({wallet:e,isOthersWallet:t,isWalletEnabled:n,enabledAccountsCount:o,totalAccountsCount:a,toggleWalletSwitch:i}){var r,s=(0,c.useCallback)((function(e){e.stopPropagation()}),[]);return(0,v.jsxs)(u.Accordion.Item,{value:n?e.id:"mockClosedItemValue","data-sentry-element":"unknown","data-sentry-component":"WalletAccordionItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:[(0,v.jsx)(u.Accordion.Trigger,_objectSpread(_objectSpread({unstyled:!0,flexDirection:"row",alignItems:"center",gap:"$3",py:"$2",px:"$5",bg:"$bgApp",borderWidth:0,disabled:!n},n&&{hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusVisibleStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineStyle:"solid",outlineOffset:0}}),{},{"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:function({open:t}){return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(u.XStack,{animation:"quick",flex:1,alignItems:"center",gap:"$3",opacity:n?1:.5,children:[(0,v.jsx)(u.YStack,{animation:"quick",rotate:t?"180deg":"0deg",children:(0,v.jsx)(u.Icon,{name:"ChevronBottomOutline",color:t?"$iconActive":"$iconSubdued"})}),(0,v.jsx)(g.L,{img:e.avatarInfo?.img,wallet:e}),(0,v.jsxs)(u.XStack,{gap:"$1",flex:1,children:[(0,v.jsx)(u.SizableText,{size:"$bodyLgMedium",numberOfLines:1,flexShrink:1,children:e.name}),(0,v.jsxs)(u.SizableText,{children:["(",o,"/",a,")"]})]})]}),(0,v.jsx)(u.Switch,{size:"small",value:n,onChange:i,onPress:s})]})}})),(0,v.jsx)(u.Accordion.HeightAnimator,{animation:"quick","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:(0,v.jsx)(u.Accordion.Content,{unstyled:!0,bg:"$bgDefault",animation:"quick",exitStyle:{opacity:0},"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:(null!=(r=e.dbAccounts)?r:e.dbIndexedAccounts)?.map((function(n){return(0,v.jsx)(AccountAccordionItemContainer,{account:n,wallet:e,isOthersWallet:t},n.id)}))})})]})}));function WalletAccordionItemContainer({wallet:e,onWalletEnabledChange:t}){var{settings:n,saveSettings:o,totalEnabledAccountsCount:a,maxAccountCount:r}=useContextAccountNotificationSettings(),s=(0,c.useRef)(a);s.current=a;var l=(0,c.useMemo)((function(){return isWalletEnabledFn({settings:n,wallet:e})}),[n,e]),u=(0,c.useMemo)((function(){return b.A.isOthersWallet({walletId:e.id})}),[e.id]),d=(0,c.useCallback)((function(n){o((function(o){var a=i()(_objectSpread({},null!=o?o:{})),c=n;if(c&&a?.[e.id]?.accounts){var l=0;Object.values(a?.[e.id]?.accounts||{}).forEach((function(e){e.enabled&&(l+=1,s.current+l>r&&(e.enabled=!1))}))}return a[e.id]=_objectSpread(_objectSpread({},a?.[e.id]),{},{enabled:c}),t({wallet:e,enabled:c}),a}))}),[r,t,o,e]),p=(0,c.useMemo)((function(){var t,n;return null!=(t=(null!=(n=e.dbAccounts)?n:e.dbIndexedAccounts)?.length)?t:0}),[e.dbAccounts,e.dbIndexedAccounts]),g=(0,c.useMemo)((function(){var t;return l?Object.values(null!=(t=n?.[e.id]?.accounts)?t:{}).filter((function(e){return!0===e.enabled})).length:0}),[l,n,e.id]);return(0,v.jsx)(h,{wallet:e,isOthersWallet:u,isWalletEnabled:l,enabledAccountsCount:g,totalAccountsCount:p,toggleWalletSwitch:d,"data-sentry-element":"WalletAccordionItemMemo","data-sentry-component":"WalletAccordionItemContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx"})}function LoadingView({show:e}){return(0,v.jsx)(u.Skeleton.Group,{show:e,"data-sentry-element":"unknown","data-sentry-component":"LoadingView","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:Array.from({length:3}).map((function(e,t){return(0,v.jsxs)(u.XStack,{alignItems:"center",px:"$5",py:"$2",children:[(0,v.jsxs)(u.XStack,{alignItems:"center",gap:"$3",flex:1,children:[(0,v.jsx)(u.Icon,{name:"ChevronBottomOutline",color:"$neutral4"}),(0,v.jsx)(u.Skeleton,{w:"$10",h:"$10",radius:8}),(0,v.jsx)(u.Skeleton.BodyLg,{})]}),(0,v.jsx)(u.Switch,{size:"small",disabled:!0})]},t)}))})}var S=(0,c.memo)((function WalletAccordionList({defaultExpandWalletId:e,wallets:t}){var[n,o]=(0,c.useState)(e),a=(0,c.useCallback)((function(e){e.enabled&&o(e.wallet.id)}),[]);return t&&t?.length?(0,v.jsx)(u.Accordion,{type:"single",collapsible:!0,value:n,onValueChange:o,"data-sentry-element":"Accordion","data-sentry-component":"WalletAccordionList","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:t.map((function(e,t){return(0,v.jsxs)(u.YStack,_objectSpread(_objectSpread({},0!==t&&{borderTopWidth:l.A.hairlineWidth,borderTopColor:"$borderSubdued"}),{},{children:[(0,v.jsx)(WalletAccordionItemContainer,{wallet:e,onWalletEnabledChange:a}),e.hiddenWallets?.map((function(e){return(0,v.jsx)(WalletAccordionItemContainer,{wallet:e,onWalletEnabledChange:a},e.id)}))]}),e.id)}))}):(0,v.jsx)(w.pC,{})}));function ManageAccountActivityContent({wallets:e}){var t=(0,s.A)(),{totalEnabledAccountsCount:n,maxAccountCount:o,settings:a}=useContextAccountNotificationSettings(),i=(0,c.useMemo)((function(){return n/o>=.9}),[n,o]),r=(0,c.useRef)();return!r.current&&a&&(r.current=function getDefaultExpandWalletId({wallets:e,settings:t}){for(var n of e){if(t[n.id]?.enabled)return n.id;for(var o of n.hiddenWallets||[])if(t[o.id]?.enabled)return o.id}return e?.[0]?.id}({wallets:e,settings:a})),(0,v.jsxs)(v.Fragment,{children:[i?(0,v.jsx)(u.Alert,{mx:"$5",mb:"$2",type:"warning",title:t.formatMessage({id:y.ETranslations.notifications_account_activity_manage_count_alert_title},{totalEnabledAccountsCount:n,maxAccountCount:o}),closable:!1}):null,a?(0,v.jsx)(S,{wallets:e,defaultExpandWalletId:r.current}):null]})}function ManageAccountActivity(){var e=(0,s.A)(),{result:{wallets:t}={wallets:[]},isLoading:n}=(0,m.yk)((function(){return d.A.serviceNotification.getNotificationWalletsAndAccounts()}),[],{watchLoading:!0});return(0,v.jsxs)(u.Page,{scrollEnabled:!0,"data-sentry-element":"Page","data-sentry-component":"ManageAccountActivity","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:[(0,v.jsx)(u.Page.Header,{title:e.formatMessage({id:y.ETranslations.global_manage}),"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx"}),(0,v.jsx)(u.Page.Body,{"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:(0,v.jsx)(AccountNotificationSettingsProvider,{wallets:t,"data-sentry-element":"AccountNotificationSettingsProvider","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Setting/pages/Notifications/ManageAccountActivity.tsx",children:n?(0,v.jsx)(LoadingView,{show:n}):(0,v.jsx)(ManageAccountActivityContent,{wallets:t})})})]})}const j=function ManageAccountActivityPage(){return(0,c.useEffect)((function(){return function(){d.A.serviceNotification.registerClientWithOverrideAllAccounts()}}),[]),(0,c.useMemo)((function(){return(0,v.jsx)(ManageAccountActivity,{})}),[])}}}]);
//# sourceMappingURL=52320.ef80f9d512.chunk.js.map