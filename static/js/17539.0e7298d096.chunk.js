!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3fd44880-5504-4166-aa9e-3543754aa372",e._sentryDebugIdIdentifier="sentry-dbid-3fd44880-5504-4166-aa9e-3543754aa372")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.5.0 (2024121652)"},(self.webpackChunkweb=self.webpackChunkweb||[]).push([[17539],{326745:(e,n,t)=>{t.d(n,{u:()=>useAppRoute});var a=t(654266);function useAppRoute(){return(0,a.lq)()}},925771:(e,n,t)=>{t.d(n,{$:()=>CalculationListItem,k:()=>CalculationList});var a=t(324586),r=t(839850),o=t(490343),i=t(831085),s=["children"],l=["children","tooltip"],c=["children"];function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,a.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function CalculationList({children:e}){return(0,i.jsx)(o.YStack,{gap:"$4","data-sentry-element":"YStack","data-sentry-component":"CalculationList","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/CalculationList/index.tsx",children:e})}function CalculationListItem(e){var{children:n}=e,t=(0,r.A)(e,s);return(0,i.jsx)(o.XStack,_objectSpread(_objectSpread({animation:"quick",enterStyle:{opacity:0},justifyContent:"space-between",alignItems:"center"},t),{},{"data-sentry-element":"XStack","data-sentry-component":"CalculationListItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/CalculationList/index.tsx",children:n}))}CalculationList.Item=CalculationListItem,CalculationListItem.Label=function CalculationListItemLabel(e){var{children:n,tooltip:t}=e,a=(0,r.A)(e,l),s=(0,i.jsx)(o.SizableText,_objectSpread(_objectSpread({color:"$textSubdued"},a),{},{children:n}));return t?(0,i.jsxs)(o.XStack,{gap:"$1",ai:"center",children:[s,(0,i.jsx)(o.Popover.Tooltip,{iconSize:"$5",title:n,tooltip:t,placement:"top"})]}):s},CalculationListItem.Value=function CalculationListItemValue(e){var{children:n}=e,t=(0,r.A)(e,c);return(0,i.jsx)(o.SizableText,_objectSpread(_objectSpread({size:"$bodyLgMedium"},t),{},{"data-sentry-element":"SizableText","data-sentry-component":"CalculationListItemValue","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/CalculationList/index.tsx",children:n}))}},713989:(e,n,t)=>{t.d(n,{G:()=>StakeShouldUnderstand,a:()=>WithdrawShouldUnderstand});var a=t(908867),r=t(490343),o=t(334439),i=t(831085),ShouldUnderstandListItemListItem=function({title:e,description:n,index:t}){return(0,i.jsxs)(r.YStack,{"data-sentry-element":"YStack","data-sentry-component":"ShouldUnderstandListItemListItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:[(0,i.jsxs)(r.XStack,{"data-sentry-element":"XStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:[(0,i.jsx)(r.Stack,{w:"$5","data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:(0,i.jsxs)(r.SizableText,{"data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:[t,"."]})}),(0,i.jsx)(r.Stack,{flex:1,"data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:(0,i.jsx)(r.SizableText,{"data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:e})})]}),n?(0,i.jsx)(r.XStack,{pl:"$5",children:(0,i.jsx)(r.SizableText,{children:n})}):null]})},ShouldUnderstand=function({items:e}){return(0,i.jsx)(r.YStack,{flex:1,"data-sentry-element":"YStack","data-sentry-component":"ShouldUnderstand","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:(0,i.jsx)(r.ScrollView,{maxHeight:560,"data-sentry-element":"ScrollView","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:(0,i.jsx)(r.YStack,{gap:"$5","data-sentry-element":"YStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx",children:e.map((function(e,n){return(0,i.jsx)(ShouldUnderstandListItemListItem,{index:n+1,title:e.title,description:e.description},n)}))})})})},createTypography=function(e,n){return n?e:""},StakeShouldUnderstand=function({provider:e,symbol:n,apr:t,updateFrequency:s,receiveSymbol:l,unstakingPeriod:c}){var d=(0,a.A)(),u=[];return u="everstake"===e&&["sol","eth","apt"].includes(n)?[createTypography(d.formatMessage({id:o.ETranslations.earn_earn_up_to_number_per_year},{number:(0,i.jsxs)(r.SizableText,{color:"$textSuccess",children:[t,"%"]})}),t),createTypography(d.formatMessage({id:o.ETranslations.earn_rewards_updated_around_time},{time:(0,i.jsx)(r.SizableText,{color:"$textSuccess",children:s})}),s),createTypography(d.formatMessage({id:o.ETranslations.earn_rewards_automatically_restaked},{automatically:(0,i.jsx)(r.SizableText,{color:"$textSuccess",children:d.formatMessage({id:o.ETranslations.earn_automatically})})}),!0),createTypography(d.formatMessage({id:o.ETranslations.earn_withdrawal_up_to_number_days},{number:c}),c)]:"everstake"===e&&["atom","matic"].includes(n)?[createTypography(d.formatMessage({id:o.ETranslations.earn_earn_up_to_number_per_year},{number:(0,i.jsxs)(r.SizableText,{color:"$textSuccess",children:[t,"%"]})}),{number:t}),createTypography(d.formatMessage({id:o.ETranslations.earn_rewards_updated_around_time},{time:(0,i.jsx)(r.SizableText,{color:"$textSuccess",children:s})}),s),createTypography(d.formatMessage({id:o.ETranslations.earn_rewards_manually_restaked},{manually:(0,i.jsx)(r.SizableText,{color:"$textSuccess",children:d.formatMessage({id:o.ETranslations.earn_manually})})}),!0),createTypography(d.formatMessage({id:o.ETranslations.earn_withdrawal_up_to_number_days},{number:c}),c)]:"lido"===e&&["eth","matic"].includes(n)?[createTypography(d.formatMessage({id:o.ETranslations.earn_earn_up_to_number_per_year},{number:(0,i.jsxs)(r.SizableText,{color:"$textSuccess",children:[t,"%"]})}),t),createTypography(d.formatMessage({id:o.ETranslations.earn_receive_token_trade_anytime},{token:(0,i.jsx)(r.SizableText,{color:"$textSuccess",children:l})}),l),createTypography(d.formatMessage({id:o.ETranslations.earn_rewards_updated_around_time},{time:(0,i.jsx)(r.SizableText,{color:"$textSuccess",children:s})}),s),createTypography(d.formatMessage({id:o.ETranslations.earn_rewards_automatically_restaked},{automatically:(0,i.jsx)(r.SizableText,{color:"$textSuccess",children:d.formatMessage({id:o.ETranslations.earn_automatically})})}),!0),createTypography(d.formatMessage({id:o.ETranslations.earn_withdrawal_up_to_number_days},{number:c}),c)]:"babylon"===e?[d.formatMessage({id:o.ETranslations.earn_stake_through_onekey_earn_points}),d.formatMessage({id:o.ETranslations.earn_check_staking_results_overflow}),createTypography(d.formatMessage({id:o.ETranslations.earn_early_withdraw_stake_unstaking_period},{number:c}),c)]:[createTypography(d.formatMessage({id:o.ETranslations.earn_earn_up_to_number_per_year},{number:(0,i.jsx)(r.SizableText,{color:"$textSuccess",children:null!=t?t:4})}),!0)],(0,i.jsx)(ShouldUnderstand,{items:u.filter((function(e){return!!e})).map((function(e){return{title:e}})),"data-sentry-element":"ShouldUnderstand","data-sentry-component":"StakeShouldUnderstand","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx"})},WithdrawShouldUnderstand=function({withdrawalPeriod:e}){var n=(0,a.A)();return(0,i.jsx)(ShouldUnderstand,{items:[{title:n.formatMessage({id:o.ETranslations.earn_withdrawal_take_up_to_number_days},{number:e})},{title:n.formatMessage({id:o.ETranslations.earn_claim_assets_after_processing})}],"data-sentry-element":"ShouldUnderstand","data-sentry-component":"WithdrawShouldUnderstand","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/EarnShouldUnderstand/index.tsx"})}},286192:(e,n,t)=>{t.d(n,{BA:()=>EstimateNetworkFee,QL:()=>useShowClaimEstimateGasAlert,fH:()=>calcDaysSpent,sM:()=>useShowStakeEstimateGasAlert});var a=t(514041),r=t(241440),o=t(908867),i=t(490343),s=t(471169),l=t(334439),c=t(925771),d=t(831085),useShowStakeEstimateGasAlert=function(){var e=(0,o.A)(),[{currencyInfo:{symbol:n}}]=(0,s.useSettingsPersistAtom)();return(0,a.useCallback)((function({daysConsumed:t,estFiatValue:a,onConfirm:r}){var o=t?e.formatMessage({id:l.ETranslations.earn_transaction_loss_when_stake},{number:(0,d.jsx)(i.SizableText,{size:"$bodyLgMedium",color:"$textCaution",children:t})}):void 0;i.Dialog.show({title:e.formatMessage({id:l.ETranslations.earn_transaction_loss}),icon:"InfoCircleOutline",description:o,renderContent:(0,d.jsxs)(i.XStack,{children:[(0,d.jsxs)(i.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.global_est_network_fee}),":"]}),(0,d.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:a})]}),onConfirm:r})}),[e,n])},useShowClaimEstimateGasAlert=function(){var e=(0,o.A)(),[{currencyInfo:{symbol:n}}]=(0,s.useSettingsPersistAtom)();return(0,a.useCallback)((function({claimTokenFiatValue:t,estFiatValue:a,onConfirm:o}){var s=(0,r.A)(t).minus(a).absoluteValue().toFixed(),c=e.formatMessage({id:l.ETranslations.earn_transaction_loss_when_claim},{number:(0,d.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",color:"$textCaution",formatterOptions:{currency:n},children:s})});i.Dialog.show({title:e.formatMessage({id:l.ETranslations.earn_transaction_loss}),icon:"InfoCircleOutline",description:c,renderContent:(0,d.jsxs)(i.YStack,{children:[(0,d.jsxs)(i.XStack,{children:[(0,d.jsxs)(i.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.global_est_network_fee}),":"]}),(0,d.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:a})]}),(0,d.jsxs)(i.XStack,{children:[(0,d.jsxs)(i.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.earn_reward_value}),":"]}),(0,d.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:t})]})]}),onConfirm:o})}),[e,n])},EstimateNetworkFeeListItem=function({estFiatValue:e,onPress:n}){var t=(0,o.A)(),[{currencyInfo:{symbol:a}}]=(0,s.useSettingsPersistAtom)();return Number(e)>0?(0,d.jsxs)(c.$,{onPress:n,children:[(0,d.jsx)(c.$.Label,{children:t.formatMessage({id:l.ETranslations.global_est_network_fee})}),(0,d.jsxs)(i.XStack,{alignItems:"center",cursor:n?"pointer":void 0,mr:n?-6:void 0,children:[(0,d.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:a},children:e}),n?(0,d.jsx)(i.Icon,{name:"ChevronRightSmallOutline",size:24}):null]})]}):null},calcDaysSpent=function(e,n){var t=(0,r.A)(n).div(e).multipliedBy(365);return t.isNaN()?void 0:Math.ceil(t.toNumber())},EstimateNetworkFee=function({estimateFeeResp:e,onPress:n,isVisible:t}){return e&&t?(0,d.jsx)(EstimateNetworkFeeListItem,{estFiatValue:e.feeFiatValue,onPress:n}):null}},87474:(e,n,t)=>{t.d(n,{A:()=>StakingFormWrapper});var a=t(324586),r=t(839850),o=t(490343),i=t(831085),s=["children"];function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,a.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function StakingFormWrapper(e){var{children:n}=e,t=(0,r.A)(e,s);return(0,i.jsx)(o.YStack,_objectSpread(_objectSpread({p:"$5",gap:"$5"},t),{},{"data-sentry-element":"YStack","data-sentry-component":"StakingFormWrapper","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/StakingFormWrapper/index.tsx",children:n}))}},90393:(e,n,t)=>{t.d(n,{Z:()=>useProviderLabel});var a=t(908867),r=t(334439),useProviderLabel=function(e){var n=(0,a.A)(),t=n.formatMessage({id:r.ETranslations.global_protocol});return"everstake"===e.toLowerCase()?t=n.formatMessage({id:r.ETranslations.earn_validator}):"babylogn"===e.toLowerCase()&&(t=n.formatMessage({id:r.ETranslations.earn_finality_provider})),t}},653913:(e,n,t)=>{t.d(n,{B8:()=>useUniversalStake,D0:()=>useUniversalClaim,Pg:()=>useUniversalWithdraw});var a=t(586330),r=t(324586),o=t(514041),i=t(241440),s=t(643087),l=t(927799),c=t(553083),d=t(161024),u=t(286192);function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var p,createStakeInfoWithOrderId=function({stakingInfo:e,orderId:n}){return _objectSpread(_objectSpread({},e),{},{orderId:n})},m=(p=(0,a.A)((function*({data:e,stakeInfo:n,networkId:t,onSuccess:a}){Array.isArray(e)&&1===e.length&&e[0].signedTx?.txid&&n.orderId&&(yield s.A.serviceStaking.addEarnOrder({orderId:n.orderId,networkId:t,txId:e[0].signedTx.txid,status:e[0].decodedTx.status})),a?.(e)})),function handleStakeSuccess(e){return p.apply(this,arguments)});function useUniversalStake({networkId:e,accountId:n}){var t,{navigationToSendConfirm:r}=(0,l.E)({accountId:n,networkId:e});return(0,o.useCallback)((t=(0,a.A)((function*({amount:t,symbol:o,term:i,feeRate:l,provider:d,stakingInfo:u,onSuccess:p,onFail:f}){var k,g,y=yield s.A.serviceStaking.buildStakeTransaction({amount:t,networkId:e,accountId:n,symbol:o,term:i,provider:d,feeRate:l}),b=yield s.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:y.tx});c.Ay.isBTCNetwork(e)&&b.fee&&(k=!0,g=!1);var h,x=createStakeInfoWithOrderId({stakingInfo:u,orderId:y.orderId});yield r({encodedTx:b,stakingInfo:x,onSuccess:(h=(0,a.A)((function*(n){yield m({data:n,stakeInfo:x,networkId:e,onSuccess:p})})),function onSuccess(e){return h.apply(this,arguments)}),onFail:f,useFeeInTx:k,feeInfoEditable:g})})),function(e){return t.apply(this,arguments)}),[r,n,e])}function useUniversalWithdraw({networkId:e,accountId:n}){var t,{navigationToSendConfirm:r}=(0,l.E)({accountId:n,networkId:e});return(0,o.useCallback)((t=(0,a.A)((function*({amount:t,symbol:o,provider:i,identity:l,stakingInfo:u,onSuccess:p,onFail:f}){var k,g=yield s.A.serviceStaking.getStakingConfigs({networkId:e,symbol:o,provider:i});if(!g)throw new Error("Staking config not found");if(g?.unstakeWithSignMessage){var y=yield s.A.serviceAccount.getAccount({accountId:n,networkId:e}),{message:b,deadline:h}=yield s.A.serviceStaking.buildLidoEthPermitMessageData({accountId:n,networkId:e,amount:t}),x=yield s.A.serviceDApp.openSignMessageModal({accountId:n,networkId:e,request:{origin:"https://lido.fi/",scope:"ethereum"},unsignedMessage:{type:d.$.TYPED_DATA_V4,message:b,payload:[y.address,b]},walletInternalSign:!0});k=yield s.A.serviceStaking.buildUnstakeTransaction({amount:t,networkId:e,accountId:n,symbol:o,provider:i,signature:x,deadline:h})}else k=yield s.A.serviceStaking.buildUnstakeTransaction({amount:t,identity:l,networkId:e,accountId:n,symbol:o,provider:i});var w,S,v=yield s.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:k.tx});c.Ay.isBTCNetwork(e)&&v.fee&&(w=!0,S=!1);var _,j=createStakeInfoWithOrderId({stakingInfo:u,orderId:k.orderId});yield r({encodedTx:v,stakingInfo:u,signOnly:g?.withdrawSignOnly,useFeeInTx:w,feeInfoEditable:S,onSuccess:(_=(0,a.A)((function*(t){if(g?.withdrawSignOnly){var a=t[0].signedTx.finalizedPsbtHex;a&&l&&(yield s.A.serviceStaking.unstakePush({txId:l,networkId:e,accountId:n,symbol:o,provider:i,unstakeTxHex:a}),p?.(t))}else yield m({data:t,stakeInfo:j,networkId:e,onSuccess:p})})),function onSuccess(e){return _.apply(this,arguments)}),onFail:f})})),function(e){return t.apply(this,arguments)}),[n,e,r])}function useUniversalClaim({networkId:e,accountId:n}){var t,{navigationToSendConfirm:r}=(0,l.E)({accountId:n,networkId:e}),d=(0,u.QL)();return(0,o.useCallback)((t=(0,a.A)((function*({identity:t,amount:o,provider:l,symbol:u,stakingInfo:p,onSuccess:f,onFail:k}){var g,y=(g=(0,a.A)((function*(){var i,d,g=yield s.A.serviceStaking.buildClaimTransaction({networkId:e,accountId:n,symbol:u,provider:l,amount:o,identity:t}),y=yield s.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:g.tx});c.Ay.isBTCNetwork(e)&&y.fee&&(i=!0,d=!1);var b,h=createStakeInfoWithOrderId({stakingInfo:p,orderId:g.orderId});yield r({encodedTx:y,stakingInfo:p,onSuccess:(b=(0,a.A)((function*(n){yield m({data:n,stakeInfo:h,networkId:e,onSuccess:f})})),function onSuccess(e){return b.apply(this,arguments)}),onFail:k,useFeeInTx:i,feeInfoEditable:d})})),function continueClaim(){return g.apply(this,arguments)});if(Number(o)>0){var b=yield s.A.serviceStaking.estimateFee({networkId:e,provider:l,symbol:u,action:"claim",amount:o}),h=(0,i.A)(b.token.price).multipliedBy(o);if(h.lt(b.feeFiatValue))return void d({claimTokenFiatValue:h.toFixed(),estFiatValue:b.feeFiatValue,onConfirm:y})}yield y()})),function(e){return t.apply(this,arguments)}),[r,n,e,d])}},717539:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Withdraw});var a=t(586330),r=t(514041),o=t(241440),i=t(908867),s=t(490343),l=t(643087),c=t(498356),d=t(326745),u=t(911998),p=t(334439),m=t(296827),f=t(73197),k=t(550082),g=t(578104),y=t(88803),b=t(471169),h=t(905817),x=t(925771),w=t(713989),S=t(286192),v=t(87474),_=t(831085),UniversalWithdraw_isNaN=function(e){return(0,o.A)(e).isNaN()||"string"==typeof e&&e.endsWith(".")},UniversalWithdraw=function({balance:e,price:n,accountId:t,networkId:c,tokenImageUri:d,tokenSymbol:u,providerLogo:m,providerName:f,initialAmount:k,minAmount:j="0",showDetailWithdrawalRequested:I,unstakingPeriod:T,providerLabel:A,decimals:E,showPayWith:C,payWithToken:M,payWithTokenRate:O="1",hideReceived:$,estimateFeeResp:P,onConfirm:L}){var z,U=Number(n)>0?n:"0",[F,N]=(0,r.useState)(!1),[W,D]=(0,r.useState)(null!=k?k:""),[{currencyInfo:{symbol:R}}]=(0,b.useSettingsPersistAtom)(),V=(0,i.A)(),B=(0,r.useCallback)((0,a.A)((function*(){var e,n;s.Dialog.show({renderIcon:(0,_.jsx)(s.Image,{width:"$14",height:"$14",src:null!=d?d:""}),title:V.formatMessage({id:p.ETranslations.earn_provider_asset_withdrawal},{provider:(0,h.c)(null!=f?f:""),asset:null!=(e=u?.toUpperCase())?e:""}),renderContent:(0,_.jsx)(w.a,{withdrawalPeriod:null!=T?T:3}),onConfirm:(n=(0,a.A)((function*(e){try{N(!0),yield e.close(),yield L?.(W)}finally{N(!1)}})),function onConfirm(e){return n.apply(this,arguments)}),onConfirmText:V.formatMessage({id:p.ETranslations.global_withdraw}),showCancelButton:!1})})),[W,L,V,d,u,f,T]),[Y,X]=(0,r.useState)(""),q=(0,g.YQ)((z=(0,a.A)((function*(e){if(!UniversalWithdraw_isNaN(e)){var n=yield l.A.serviceStaking.checkAmount({accountId:t,networkId:c,symbol:u,provider:f,action:"unstake",amount:e});X(n)}})),function(e){return z.apply(this,arguments)}),300),K=(0,r.useCallback)((function(e){if(new o.A(e).isNaN())""===e&&D("");else{var n=Boolean(E&&Number(E)>0&&(0,h.FZ)(e)>E);D(n?function(e){return e}:e),q(e)}}),[q,E]),H=(0,r.useMemo)((function(){if(Number(W)>0&&Number(U)>0)return(0,o.A)(W).multipliedBy(U).toFixed()}),[W,U]),Z=(0,r.useMemo)((function(){if(Number(j)>0){var n=new o.A(Number(j)),t=new o.A(W),a=new o.A(e);if(n.gt(0)&&t.gt(0)&&a.gte(0))return t.gt(0)&&t.gte(n)&&a.minus(t).gt(0)&&a.minus(t).lt(n)}return!1}),[j,W,e]),Q=(0,r.useCallback)((function(){K(e)}),[K,e]),G=W?.length>0&&!!Y,J=(0,r.useMemo)((function(){return UniversalWithdraw_isNaN(W)||(0,o.A)(W).isLessThanOrEqualTo(0)||G}),[W,G]),ee=void 0===k;return(0,_.jsxs)(v.A,{"data-sentry-element":"StakingFormWrapper","data-sentry-component":"UniversalWithdraw","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/UniversalWithdraw/index.tsx",children:[(0,_.jsxs)(s.Stack,{position:"relative",opacity:ee?1:.7,"data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/UniversalWithdraw/index.tsx",children:[(0,_.jsx)(y.J,{bg:ee?"$bgApp":"$bgDisabled",hasError:G,value:W,onChange:K,tokenSelectorTriggerProps:{selectedTokenImageUri:d,selectedTokenSymbol:u},inputProps:{placeholder:"0",autoFocus:ee},balanceProps:{value:e,iconText:V.formatMessage({id:p.ETranslations.earn_staked}),onPress:Q},valueProps:{value:H,currency:H?R:void 0},enableMaxAmount:!0,"data-sentry-element":"AmountInput","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/UniversalWithdraw/index.tsx"}),ee?null:(0,_.jsx)(s.Stack,{position:"absolute",w:"100%",h:"100%",zIndex:1})]}),Z?(0,_.jsx)(s.Alert,{icon:"InfoCircleOutline",type:"warning",title:V.formatMessage({id:p.ETranslations.earn_unstake_all_due_to_min_withdrawal},{number:j,symbol:u})}):null,G?(0,_.jsx)(s.Alert,{icon:"InfoCircleOutline",type:"critical",title:Y}):null,(0,_.jsxs)(x.k,{"data-sentry-element":"CalculationList","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/UniversalWithdraw/index.tsx",children:[W&&!$?(0,_.jsxs)(x.$,{children:[(0,_.jsx)(x.$.Label,{children:V.formatMessage({id:p.ETranslations.earn_receive})}),(0,_.jsx)(x.$.Value,{children:(0,_.jsx)(s.NumberSizeableText,{formatter:"balance",size:"$bodyLgMedium",formatterOptions:{tokenSymbol:u},children:W})})]}):null,C&&M&&Number(W)>0?(0,_.jsxs)(x.$,{children:[(0,_.jsx)(x.$.Label,{children:V.formatMessage({id:p.ETranslations.earn_pay_with})}),(0,_.jsx)(x.$.Value,{children:(0,_.jsx)(s.NumberSizeableText,{formatter:"balance",size:"$bodyLgMedium",formatterOptions:{tokenSymbol:M},children:(0,o.A)(W).multipliedBy(O).toFixed()})})]}):null,m&&f?(0,_.jsxs)(x.$,{children:[(0,_.jsx)(x.$.Label,{children:null!=A?A:V.formatMessage({id:p.ETranslations.global_protocol})}),(0,_.jsx)(x.$.Value,{children:(0,_.jsxs)(s.XStack,{gap:"$2",alignItems:"center",children:[(0,_.jsx)(s.Image,{width:"$5",height:"$5",src:m,borderRadius:"$2"}),(0,_.jsx)(s.SizableText,{size:"$bodyLgMedium",children:(0,h.c)(f)})]})})]}):null,T?(0,_.jsxs)(x.$,{children:[(0,_.jsxs)(s.XStack,{flex:1,alignItems:"center",gap:"$1",children:[(0,_.jsx)(x.$.Label,{children:V.formatMessage({id:p.ETranslations.earn_unstaking_period})}),(0,_.jsx)(s.Popover,{title:V.formatMessage({id:p.ETranslations.earn_unstaking_period}),placement:"top",renderTrigger:(0,_.jsx)(s.IconButton,{iconColor:"$iconSubdued",size:"small",icon:"InfoCircleOutline",variant:"tertiary"}),renderContent:(0,_.jsx)(s.Stack,{p:"$5",children:(0,_.jsx)(s.SizableText,{children:V.formatMessage({id:p.ETranslations.earn_unstaking_period_tooltip})})})})]}),(0,_.jsx)(x.$.Value,{children:V.formatMessage({id:I?p.ETranslations.earn_claim_available_in_number_days:p.ETranslations.earn_up_to_number_days},{number:T})})]}):null,P?(0,_.jsx)(S.BA,{estimateFeeResp:P,isVisible:Number(W)>0}):null]}),(0,_.jsx)(s.Page.Footer,{onConfirmText:V.formatMessage({id:p.ETranslations.global_continue}),confirmButtonProps:{onPress:B,loading:F,disabled:J},"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/components/UniversalWithdraw/index.tsx"})]})},j=t(90393),I=t(653913);const Withdraw=function(){var e,n=(0,i.A)(),t=(0,d.u)(),{accountId:g,networkId:y,details:b,identity:x,amount:w,onSuccess:S}=t.params,{token:v,provider:T,active:A,overflow:E}=b,{price:C,info:M}=v,O=(0,h.Y)(b),$=(0,c.A)(),P=(0,I.Pg)({accountId:g,networkId:y}),L=(0,r.useCallback)((e=(0,a.A)((function*(e){yield P({amount:e,identity:x,symbol:M.symbol,provider:T.name,stakingInfo:{label:k.D.Withdraw,protocol:T.name,protocolLogoURI:T.logoURI,tags:[O]},onSuccess:function(){$.pop(),m.U.staking.page.unstaking({token:M,stakingProtocol:T.name}),S?.()}})})),function(n){return e.apply(this,arguments)}),[P,M,$,T,O,x,S]),z=(0,j.Z)(T.name),U=(0,r.useMemo)((function(){return"lido"===T.name.toLowerCase()}),[T]),F=(0,r.useMemo)((function(){return"everstake"===T.name.toLowerCase()&&"apt"===M.symbol.toLowerCase()}),[T,M.symbol]),{result:N}=(0,u.yk)((0,a.A)((function*(){return yield l.A.serviceStaking.estimateFee({networkId:y,provider:T.name,symbol:M.symbol,action:"unstake",amount:"1",txId:T.name.toLowerCase()===f.e.Babylon.toLowerCase()?x:void 0})})),[y,T.name,M.symbol,x]),{unstakingPeriod:W,showDetailWithdrawalRequested:D}=(0,r.useMemo)((function(){var e=!!b?.provider?.unstakingTime;return{showDetailWithdrawalRequested:e,unstakingPeriod:e?Math.ceil(Number(b.provider.unstakingTime)/86400):b.unstakingPeriod}}),[b]);return(0,_.jsxs)(s.Page,{"data-sentry-element":"Page","data-sentry-component":"WithdrawPage","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/pages/Withdraw/index.tsx",children:[(0,_.jsx)(s.Page.Header,{title:n.formatMessage({id:p.ETranslations.earn_withdraw_token},{token:M.symbol}),"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/pages/Withdraw/index.tsx"}),(0,_.jsx)(s.Page.Body,{"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/pages/Withdraw/index.tsx",children:(0,_.jsx)(UniversalWithdraw,{price:C,hideReceived:F,decimals:b.token.info.decimals,balance:(0,o.A)(null!=A?A:0).plus(null!=E?E:0).toFixed(),accountId:g,networkId:y,initialAmount:w,tokenSymbol:M.symbol,tokenImageUri:M.logoURI,providerLogo:T.logoURI,providerName:T.name,onConfirm:L,minAmount:Number(T.minUnstakeAmount)>0?String(T.minUnstakeAmount):void 0,showDetailWithdrawalRequested:D,unstakingPeriod:W,providerLabel:z,showPayWith:U,payWithToken:b.rewardToken,payWithTokenRate:T.lidoStTokenRate,estimateFeeResp:N,"data-sentry-element":"UniversalWithdraw","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Staking/pages/Withdraw/index.tsx"})})]})}},905817:(e,n,t)=>{t.d(n,{FZ:()=>countDecimalPlaces,Y:()=>buildLocalTxStatusSyncId,c:()=>capitalizeString});var a=t(241440),buildLocalTxStatusSyncId=function(e){return`${e.provider.name.toLowerCase()}-${e.token.info.symbol.toLowerCase()}`};function capitalizeString(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function countDecimalPlaces(e){var n="string"==typeof e?Number(e):e;if(Number.isNaN(n))return 0;var t="string"==typeof e?e:(0,a.A)(e).toFixed(),r=t.indexOf(".");return-1===r?0:t.length-r-1}}}]);
//# sourceMappingURL=17539.0e7298d096.chunk.js.map